!function(){angular.module("acComponents.config",[]).value("acComponents.config",{debug:!0}).value("acConfig",{reportTypes:["quick","avalanche","snowpack","weather","incident"],minFilters:["avalanche","quick","snowpack","incident","weather"],dateFilters:["1-days","3-days","7-days","14-days","30-days"],maxZoom:20}).constant("AC_API_ROOT_URL","http://avalanche-canada-min.elasticbeanstalk.com"),angular.module("acComponents.controllers",[]),angular.module("acComponents.directives",[]),angular.module("acComponents.filters",[]),angular.module("acComponents.services",[]),angular.module("acComponents",["acComponents.config","acComponents.controllers","acComponents.directives","acComponents.filters","acComponents.services","acComponents.templates","ngSanitize"]),angular.module("acComponents.controllers").controller("acBackModal",["$scope","$modalInstance",function(e,a){e.discardAndExit=function(){a.close(!0)},e.stayOnThePage=function(){a.dismiss()}}]),angular.module("acComponents.controllers").controller("acMapModal",["$scope","$modalInstance","latlng","$timeout",function(e,a,t,i){e.params={latlng:t},e.save=function(){e.params.latlng[0]=e.params.latlng[0].toFixed(5),e.params.latlng[1]=e.params.latlng[1].toFixed(5),a.close(e.params.latlng)},a.opened.then(function(){i(function(){e.show=!0},0)})}]),angular.module("acComponents.directives").directive("acAllminIcon",function(){return{replace:!0,templateUrl:"allmin-icon.html",link:function(){}}}),angular.module("acComponents.directives").directive("acDangerIcon",function(){return{replace:!0,templateUrl:"danger-icon.html",link:function(){}}}),angular.module("acComponents.directives").directive("acDatetimePicker",function(){return{scope:{showOnlyDate:"=",showOnlyTime:"=",maxDateToday:"="},link:function(e,a){if(jQuery().datetimepicker){var t={maxDate:e.maxDateToday===!0?new Date:new Date((new Date).setYear((new Date).getFullYear()+1)),pickTime:!e.showOnlyDate,format:e.showOnlyTime?"LT":e.showOnlyDate?"YYYY-MM-DD":"YYYY-MM-DD hh:mm A",pickDate:e.showOnlyTime?!e.showOnlyTime:!0};a.datetimepicker(t),jQuery(window).scroll(function(){void 0!==a.data("DateTimePicker")&&a.data("DateTimePicker").hide()})}}}}),angular.module("acComponents.directives").directive("acDrawer",function(){return{replace:!0,transclude:!0,scope:!0,templateUrl:"drawer.html",link:function(e,a,t){e.drawerPosition=t.acDrawerPosition}}}),angular.module("acComponents.directives").directive("acEnter",function(){return function(e,a,t){a.bind("keydown keypress",function(a){13===a.which&&(e.$apply(function(){e.$eval(t.acEnter)}),a.preventDefault())})}}),angular.module("acComponents.directives").directive("acForecastMini",["AC_API_ROOT_URL",function(e){return{templateUrl:"forecast-mini.html",scope:{forecast:"=acForecast",dangerRating:"=dangerRating",disclaimer:"=disclaimer",sponsor:"=sponsor"},link:function(a,t){t.addClass("ac-forecast-mini"),a.apiUrl=e}}}]).directive("acForecastMiniExternal",["AC_API_ROOT_URL",function(){return{restrict:"E",templateUrl:"forecast-mini-external.html",scope:{forecast:"="}}}]).directive("acForecastMiniParks",["AC_API_ROOT_URL",function(){return{restrict:"E",templateUrl:"forecast-mini-parks.html",scope:{forecast:"="}}}]).directive("acForecastMiniAvalx",["AC_API_ROOT_URL",function(){return{restrict:"E",templateUrl:"forecast-mini-avalx.html",scope:{forecast:"=",dangerRating:"=",disclaimer:"=",sponsor:"="}}}]).directive("whistlerLinks",["AC_API_ROOT_URL",function(){return{restrict:"E",templateUrl:"wbc-links.html"}}]),angular.module("acComponents.directives").directive("acHotZoneMini",["AC_API_ROOT_URL",function(e){return{templateUrl:"hot-zone-mini.html",scope:{},link:function(a,t){t.addClass("ac-forecast-mini"),a.apiUrl=e,a.hotZone={dateIssued:Date(),validUntil:Date(),infoSummary:'<p>Hot Zone Reports are not the equivalent of a daily avalanche forecast. They are general summaries of local conditions and provide general risk management advice for users who have enough training and knowledge to recognize avalanche terrain and use the information here as part of their risk management process.</p><p>Conditions may vary significantly over space so the boundaries of this Hot Zone Report as shown on the map should not be taken literally. They are a general representation of the area within which the information and advice contained in the report may be applicable. Conditions may vary significantly over time. The information and associated advice and recommendations may become invalid before the “valid until” date.</p><p>Hot Zone Reports are based largely on Mountain Information Network submissions from this area. You can help by reporting your observations using the <a href="http://www.avalanche.ca/mountain-information-network">Mountain Information Network.</a></p><p>All users, but especially those with little or no avalanche training are advised to be familiar with and utilize avalanche risk reduction procedures at all times to lower the chance of an avalanche accident and reduce the severity of consequences if one does occur.</p><p>Even if all the information in this report is correct and you follow all the recommendations in this Hot Zone Report and apply all avalanche risk reduction procedures, you can still be caught in an avalanche. Ensure all members of your party have an avalanche transceiver, probe, and shovel on their person at all times; that everyone has been trained in and practiced the use of avalanche rescue gear; and that all rescue equipment is well maintained and has been tested. </p><p>If you have questions or concerns about Hot Zone Reports or want to learn more about how to get a Hot Zone Report in your area, contact: Avalanche Canada’s Public Avalanche Warning Service Manager, Karl Klassen at <a href="mailto:kklassen@avalanche.ca">kklassen@avalanche.ca.</a></p>'}}}}]),angular.module("acComponents.directives").directive("acHotZoneReportForm",["$state","$rootScope","$q","$timeout","acBreakpoint","acReportData","acFormUtils","acSubmission","MAPBOX_ACCESS_TOKEN","MAPBOX_MAP_ID","store","$anchorScroll","$modal","ngToast",function(e,a,t,i,n,o,l,s,r,c,d,p,u){return{templateUrl:"hot-zone-report-form.html",replace:!0,link:function(a){function t(){a.report={headline:"",dateissue:moment().format("YYYY-MM-DD hh:mm A"),datevalid:moment().format("YYYY-MM-DD hh:mm A"),location:null,files:[],obs:{criticalFactors:angular.copy(o.hotzone.criticalFactors),terrainAvoidanceList:angular.copy(o.hotzone.terrainAvoidanceList),travelAdvice:angular.copy(o.hotzone.travelAdvice)}}}function n(){i(function(){l(),t(),a.submitting=!1,a.error=!1},0)}function l(){o.hotzone.criticalFactors.reset(),o.hotzone.terrainAvoidanceList.reset(),o.hotzone.travelAdvice.reset()}l(),t(),a.scrollToTop=function(){p.yOffset=100,p("top")},a.locations=["Renshaw","Kakwa"],a.resetForm=n,a.goBack=function(){l(),t(),e.go("ac.map")},a.submitForm=function(){a.report.location||(a.invalidLatLng=!0)}}}}]),angular.module("acComponents.directives").directive("acLoadingIndicator",function(){return{templateUrl:"loading-indicator.html",replace:!0,link:function(){}}}),angular.module("acComponents.directives").directive("acLocationSelect",["MAPBOX_ACCESS_TOKEN","MAPBOX_MAP_ID","$timeout",function(e,a,t){return{scope:{latlng:"="},link:function(i,n){function o(e){t(function(){i.latlng=[e.lat,e.lng]},0)}function l(e){c.setPopupContent("Position: "+e.toString().substr(6)+"<br/>(drag to relocate)"),c.openPopup()}function s(e){c=L.marker(e,{icon:L.mapbox.marker.icon({"marker-color":"4B6D6F"}),draggable:!0}),c.bindPopup("Position: "+e.toString().substr(6)+"<br/>(drag to relocate)").addTo(r).openPopup(),c.on("dragend",function(){var e=c.getLatLng();l(e),o(e)})}var r,c;L.mapbox.accessToken=e,$("#minForm").on("shown.bs.modal",function(){r.invalidateSize()}),r=L.mapbox.map(n[0],a,{attributionControl:!1,scrollWheelZoom:!0}).on("click",function(e){c?c&&!r.hasLayer(c)&&(o(e.latlng),c.setLatLng(e.latlng).addTo(r).openPopup()):(o(e.latlng),s(e.latlng))}),r.setView([52.3,-120.74966],5);var d=i.$watch("latlng",function(e){var a;c&&0===e.length?r.removeLayer(c):!c&&e.length>0?(a=L.latLng(e[0],e[1]),s(a),r.panTo(a)):c&&e.length>0&&(a=L.latLng(e[0],e[1]),c.setLatLng(a),l(a),r.panTo(a))});i.$on("$destroy",function(){d()})}}}]),angular.module("acComponents.directives").directive("acMapboxMap",["$rootScope","$window","$location","$timeout","acBreakpoint","acObservation","acForecast","acSubmission","MAPBOX_ACCESS_TOKEN","MAPBOX_MAP_ID","$stateParams","acConfig","localStorageService",function(e,a,t,i,n,o,l,s,r,c,d,p,u){return{template:'<div id="map"></div>',replace:!0,scope:{region:"=acRegion",regions:"=acRegions",showRegions:"=acShowRegions",obs:"=acObs",ob:"=acOb",minFilters:"=acMinFilters",currentReport:"=acReport"},link:function(m,v,g){function f(){L.control.locate({locateOptions:{maxZoom:P.maxZoom},position:"bottomright"}).addTo(q),new L.Control.Zoom({position:"bottomright"}).addTo(q)}function h(e){return function(){v.height($(a).height()-Number(e)),q.invalidateSize()}}function b(e){var a=q.getZoom()<=6?60:80;return L.icon({iconUrl:e.iconUrl||l.getDangerIconUrl(e.regionId),iconSize:[a,a],labelAnchor:[6,0]})}function y(){N.regions=L.geoJson(m.regions,{style:function(e){var a=E(e);return a.default},onEachFeature:function(e,a){function t(){if(q.getZoom()<9){var e=R();q.fitBounds(a.getBounds(),{paddingBottomRight:e})}N.currentRegion=a,m.$apply(function(){m.region=a})}var i=E(e);if(a.bindLabel(e.properties.name),a.on("click",t),a.on("mouseover",function(){a==N.currentRegion?a.setStyle(i.selectedhover):a.setStyle(i.hover)}),a.on("mouseout",function(){a==N.currentRegion?a.setStyle(i.selected):a.setStyle(i.default)}),e.properties.centroid&&"hotzone"!==e.properties.type){var n=L.latLng(e.properties.centroid[1],e.properties.centroid[0]),o=L.marker(n),l=b({regionId:e.id});o.setIcon(l);var s=1;o.setZIndexOffset(s),o.on("click",function(){t()}),N.dangerIcons.addLayer(o)}}}),x()}function w(){N.dangerIcons.eachLayer(function(e){var a=e.options.icon.options.iconUrl,t=b({iconUrl:a});e.setIcon(t)})}function x(){var e=q.getZoom();if(N.regions&&m.showRegions){var a=q.hasLayer(N.regions);6>e&&a?q.removeLayer(N.regions):e>=6&&!a?q.addLayer(N.regions):e>10&&a&&q.removeLayer(N.regions)}if(N.dangerIcons){var t=q.hasLayer(N.dangerIcons);q.getZoom()<6&&t?q.removeLayer(N.dangerIcons):q.getZoom()>=6&&!t&&q.addLayer(N.dangerIcons);var i=N.dangerIcons.getLayers()[0];if(i){var n=i.options.icon.options.iconSize[0];(e>6&&60===n||6>=e&&80===n)&&w()}}N.obs;var o=.2;if(N.currentRegion&&m.showRegions){var l=E(N.currentRegion.feature);if(9>=e)l.selected.fillOpacity=o,N.currentRegion.setStyle(l.selected);else if(e>9&&13>e){switch(e){case 10:o=.15;break;case 11:o=.1;break;case 12:o=.05}l.selected.fillOpacity=o,N.currentRegion.setStyle(l.selected)}else N.currentRegion.setStyle(l.default)}T()}function k(e){return _.isUndefined(e)&&(e="quick"),U.reportType[e]}function T(){}function S(){if(B.clearLayers(),m.obs&&m.obs.length>0){var a=new L.markerClusterGroup(P.cluster).addTo(B);m.obs.map(function(t){var i=L.mapbox.featureLayer(P.setFeatureLayer(t.latlng[1],t.latlng[0],t.obtype,t.subid)).setFilter(function(){return-1!==_.indexOf(m.minFilters,t.obtype)?!0:!1});i.subid=t.subid,i.on("click",function(){e.requestInProgress=!0,s.getOne(t.subid).then(function(a){a.requested=t.obtype,m.currentReport=a,e.requestInProgress=!1}),q.setView(t.latlng,q.getZoom()),u.set("mapZoom",q.getZoom()),u.set("mapCenter",q.getCenter())}),i.eachLayer(function(e){a.addLayer(e)}),m.visibleObs.push(i)}),a.on("clusterclick",function(e){var a=e.layer;a.multipleReports?a.zoomToBounds():a.spiderfy()}),setTimeout(function(){if(-1!==t.path().indexOf("focus")){var e=null;_.each(m.visibleObs,function(a){return a.subid===d.markerid?(e=a,a.fire("click"),!1):void 0}),_.each(a._featureGroup.getLayers(),function(a){"function"==typeof a.getAllChildMarkers&&_.each(a.getAllChildMarkers(),function(t){_.each(e.getLayers(),function(e){return t._latlng.lat===e._latlng.lat&&t._latlng.lng===e._latlng.lng?(a.spiderfy(),!1):void 0})})})}},1e3)}else B.clearLayers();x()}function C(e){return{type:"Point",coordinates:[e.lng,e.lat]}}function R(){switch(m.device.size){case"xs":return L.point([0,0]);case"sm":return L.point([350,0]);case"md":case"lg":return L.point([480,0]);default:return L.point([0,0])}}function A(){return R().divideBy(2)}function O(e,a){var t=q.latLngToLayerPoint(e);return q.layerPointToLatLng(t.subtract(a))}function F(){var e=A();return O(q.getCenter(),e)}function M(){if(m.showRegions){var e=N.regions.getLayers(),a=F(),t=_.find(e,function(e){return gju.pointInPolygon(C(a),e.feature.geometry)});t||(t=_.min(e,function(e){var t=L.latLng(e.feature.properties.centroid[1],e.feature.properties.centroid[0]);return t.distanceTo(a)})),t&&D(t)}}function D(e){var t=e.feature.properties.type;if("link"===t||"parks"===t){var n=e.feature.properties.url;return"parks"===e.feature.properties.type&&(n=e.feature.properties.externalUrl),a.open(n,"_blank"),m.region=void 0,void 0}N.currentRegion=e,m.region!==e&&i(function(){m.region=e},10),N.regions.eachLayer(function(a){var t=E(a.feature);a===e?a.setStyle(t.selected):a.setStyle(t.default)})}function I(e){var a=e.getAllChildMarkers(),t=_.uniq(a,function(e){return e.feature.extra.subid}).length;return e.multipleReports=t>1,new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster marker-cluster-sm",iconSize:new L.Point(40,40)})}function E(e){return style="hotzone"===e.properties.type?U.hotZone:U.region}m.device={},m.showRegions=m.showRegions||!0,m.visibleObs=[];var P={maxZoom:p.maxZoom,mapSetup:{attributionControl:!1,center:[52.3,-120.74966],maxZoom:p.maxZoom,minZoom:4,zoom:6,zoomControl:!1},cluster:{iconCreateFunction:I,zoomToBoundsOnClick:!1},setFeatureLayer:function(e,a,t,i){return{type:"Feature",geometry:{type:"Point",coordinates:[e,a]},extra:{subid:i},properties:{"marker-size":"small","marker-color":k(t),zIndexOffset:1e3}}}};-1!==t.path().indexOf("focus")&&(P.mapSetup.zoom=u.get("mapZoom")||P.mapSetup.zoom,P.mapSetup.center=u.get("mapCenter")||P.mapSetup.center);var N={dangerIcons:L.featureGroup()},U={region:{"default":{fillColor:"transparent",color:"transparent"},selected:{fillColor:"#489BDF"},hover:{color:"#B43A7E"},selectedhover:{fillColor:"#489BDF",color:"#B43A7E"}},hotZone:{"default":{fillColor:"#e62e00",color:"#e62e00",weight:"1"},selected:{fillColor:"#ffff00",weight:5},hover:{color:"#e62e00",weight:5},selectedhover:{fillColor:"#ffff00",color:"#e62e00",weight:5}},reportType:{incident:"#F44336",quick:"#4CAF50",avalanche:"#03A9F4",snowpack:"#3F51B5",weather:"#FFC107"},clusterColor:"#607D8B"};L.mapbox.accessToken=r;var q=L.mapbox.map(v[0].id,c,P.mapSetup),B=L.layerGroup().addTo(q);if(f(),n.setBreakpoints({xs:480,sm:600,md:1025}),e.$on("breakpoint",function(e,a){m.device.size=a}),g.topOffset){var z=Number(g.topOffset),Z=h(z);angular.element(document).ready(Z),angular.element(a).bind("resize",Z)}q.on("load",x),q.on("zoomend",x),m.$watch("region",function(e,a){N.regions&&e&&e!==a&&D(e)}),m.$watch("regions",function(e){e&&e.features&&y()}),m.$watch("showRegions",function(e,a){if(e!==a)if(!e&&q.hasLayer(N.regions)){if(N.currentRegion){m.region=null;var t=E(N.currentRegion.feature);N.currentRegion.setStyle(t.default)}q.removeLayer(N.regions)}else e&&!q.hasLayer(N.regions)&&(q.addLayer(N.regions),M())}),m.$watch("obs",function(e){e&&S()}),m.$watch("minFilters",function(e){e&&S()},!0),m.$watch("currentReport",function(a){if(d.subid&&a&&a.latlng){B.clearLayers();var t=new L.markerClusterGroup(P.cluster).addTo(B);a.obs.map(function(i){var n=L.mapbox.featureLayer(P.setFeatureLayer(a.latlng[1],a.latlng[0],i.obtype,i.subid)).setFilter(function(){return-1!==_.indexOf(m.minFilters,i.obtype)?!0:!1});n.on("click",function(){e.requestInProgress=!0,s.getOne(a.subid).then(function(a){a.requested=i.obtype,m.currentReport=a,e.requestInProgress=!1})}),n.eachLayer(function(e){t.addLayer(e)})}),q.setView(a.latlng,10)}},!0),m.$watch("ob",function(a){a&&a.latlng&&(o.getOne(a.obid,"html").then(function(e){var n=L.marker(a.latlng,{icon:L.mapbox.marker.icon({"marker-size":"small","marker-color":"#09c"})}),o=q.getSize().y-100;n.bindPopup(e,{maxHeight:o,maxWidth:400,autoPanPaddingTopLeft:[0,30]}),n.on("popupclose",function(){q.removeLayer(n),i(function(){t.path("/")},0)}),n.setZIndexOffset(1e4),q.addLayer(n),n.togglePopup()}),o.getOne(a.obid,"json").then(function(a){e.ogTags=[{type:"title",value:a.title},{type:"image",value:a.thumbs[0]},{type:"description",value:a.comment}]}))})}}}]),angular.module("acComponents.directives").directive("fileModel",["$parse",function(e){return{restrict:"A",link:function(a,t,i){var n=e(i.fileModel),o=n.assign;t.bind("change",function(){a.$apply(function(){o(a,t[0].files)})})}}}]).directive("acMinReportForm",["$state","$rootScope","$q","$timeout","acBreakpoint","acReportData","acFormUtils","acSubmission","MAPBOX_ACCESS_TOKEN","MAPBOX_MAP_ID","store","$anchorScroll","$modal","ngToast",function(e,a,t,i,n,o,l,s,r,c,d,p,u,m){return{templateUrl:"min-report-form.html",replace:!0,link:function(a){function n(e){return"quickReport"===e?o.quick.isCompleted(a.report.obs.quickReport):a.report.obs[e].isCompleted()}function r(){a.report={title:"",datetime:moment().format("YYYY-MM-DD hh:mm A"),latlng:[],files:[],obs:{quickReport:{ridingConditions:angular.copy(o.quick.ridingConditions),avalancheConditions:angular.copy(o.quick.avalancheConditions),comment:angular.copy(o.quick.comment)},avalancheReport:o.avalanche,incidentReport:o.incident,snowpackReport:o.snowpack,weatherReport:o.weather}}}function c(){i(function(){v(),r(),a.minsubmitting=!1,a.minerror=!1},0)}function v(){o.avalanche.reset(),o.incident.reset(),o.snowpack.reset(),o.weather.reset()}var g="http://www.avalanche.ca/fxresources/Submissions+Guidelines.pdf";v(),r(),a.additionalFields={avalancheReport:{name:"avalanche",text:"Share information about a single, notable avalanche or tell us about overall avalanche conditions by describing many avalanches in a general sense. Aspect, elevation, trigger, dimensions/size are key data."},snowpackReport:{name:"snowpack",text:"Snowpack depth, layering, and bonding are key data. Test results are very useful."},weatherReport:{name:"weather",text:"Key data includes information about current and accumulated precipitation, wind speed and direction, temperatures, and cloud cover."},incidentReport:{name:"incident",text:'Sharing incidents can help us all learn. Describe close calls and accidents here. Be sensitive to the privacy of others. Before reporting serious accidents check our <a href="'+g+'" target="_blank">submission guidelines</a>.'}},a.tabs={quickReport:!0,avalancheReport:!1,snowpackReport:!1,weatherReport:!1,incidentReport:!1},a.atleastOneTabCompleted=!1,a.getTabExtraClasses=function(e){var t=n(e);return a.atleastOneTabCompleted=a.atleastOneTabCompleted||t,{completed:t,tab:e.replace("Report","")}},a.scrollToTop=function(){p.yOffset=100,p("top")},a.resetForm=c,a.goBack=function(){v(),r(),e.go("ac.map")},a.submitForm=function(){var i=_.cloneDeep(a.report);i.obs=_.reduce(a.report.obs,function(e,a,t){return"quickReport"===t?o.quick.isCompleted(a)&&(e.quickReport=a):a.isCompleted()&&(e[t]=a.getDTO()),e},{});var n=d.get("token");return n?(a.minsubmitting=!0,s.submit(i,n).then(function(i){return!i.data||"error"in i.data?(a.minsubmitting=!1,a.minerror=!0,t.reject("error")):(e.go("ac.map"),m.create({content:"Your report was successfully submitted.","class":"alert alert-success",dismissOnTimeout:!0,dismissButton:!0,dismissButtonHtml:"&times;"}),i)},function(e){return a.minsubmitting=!1,a.minerror=!0,a.minerrormsg=e,t.reject(e)})):t.reject("auth-error")},a.openMapModal=function(){var e=u.open({animation:!1,templateUrl:"min-map-modal.html",controller:"acMapModal",size:"lg",windowClass:"map-modal",resolve:{latlng:function(){return a.report.latlng}}});e.result.then(function(e){a.report.latlng=e})};var f=a.$watchCollection(function(){return[a.report.latlng,a.report.tempLatlng]},function(e,t){e&&(e[0]!==t[0]&&(a.report.tempLatlng=a.report.latlng.join(","),e[1]=a.report.tempLatlng,a.tempLatlngModified=!1),e[1]&&e[1]!==e[0].join(",")&&(a.tempLatlngModified=!0))});a.$on("$destroy",function(){f()}),a.saveLocation=function(){l.validateLocationString(a.report.tempLatlng)?(a.report.latlng=a.report.tempLatlng.split(","),a.tempLatlngModified=!1,a.invalidLatLng=!1):a.invalidLatLng=!0}}}}]),angular.module("acComponents.directives").directive("acMinReportFullPage",["acReportData",function(e){return{templateUrl:"min-report-fullpage.html",scope:{sub:"=report",sponsor:"=sponsor"},link:function(a,t){function i(){a.activeReports=_.reduce(a.sub.obs,function(a,t){return a.push({obtype:t.obtype,ob:e[t.obtype].mapDisplayResponse(t.ob)}),a},[]),a.activeReports=_.sortBy(a.activeReports,function(e){return["quick","avalanche","snowpack","weather","incident"].indexOf(e.obtype)})}function n(){window.print()}t.addClass("ac-observation-drawer"),a.print=n,a.activeReports=[],i()}}}]),angular.module("acComponents.directives").directive("acMinReportModal",function(){return{templateUrl:"min-report-modal.html",replace:!0,link:function(){}}}),angular.module("acComponents.directives").directive("acObservationMin",["acReportData","acConfig","$stateParams","$state",function(e,a,t,i){return{templateUrl:"min-observation-drawer.html",scope:{sub:"=observation",sponsor:"=sponsor"},link:function(n,o){function l(e){if(n.sub){var a=_.reduce(n.sub.obs,function(e,a){return e.push(a.obtype),e},[]);return-1!==_.indexOf(a,e)?"completed":"disabled"}}function s(){n.sub=null,(t.subid||t.markerid)&&i.go("ac.map")}function r(e){return"disabled"===l(e)?!1:(n.sub.requested=e,c(n.sub),void 0)}function c(a){a.requested=d(a);var t=_.filter(a.obs,function(e){return a.requested===e.obtype});t[0].ob&&(n.activeTab=e[a.requested].mapDisplayResponse(t[0].ob))}function d(e){if(e.requested)return e.requested;var a=null;return _.forEach(n.reportTypes,function(t){return _.some(e.obs,{obtype:t})?(a=t,!1):void 0}),a}function p(e){i.go("ac.reports",{subid:e})}o.addClass("ac-observation-drawer"),n.activeTab={},n.reportTypes=a.reportTypes,n.hasReport=l,n.changeTab=r,n.closeDrawer=s,n.viewFullPage=p,n.$watch("sub",function(e){e&&e.latlng&&c(e)})}}}]),angular.module("acComponents.directives").directive("acSocialShare",function(){return{templateUrl:"social-share.html",replace:!0,link:function(){}}}),angular.module("acComponents.directives").directive("acSubmissionFormValidator",function(){return{require:"^form",link:function(e,a,t,i){function n(e,a){angular.isDefined(i[e])&&i[e].$setValidity(e,a)}e.validate=function(e,a){a.validate()?n(e,!0):n(e,!1)},e.$watch("atleastOneTabCompleted",function(e){angular.isDefined(e)&&i.$setValidity("atleastOneTab",e)})}}}),angular.module("acComponents.directives").directive("acTabStyle",function(){return{link:function(e,a,t){function i(e){var t=JSON.parse(e);_.forEach(t,function(e,t){"tab"===t&&a.find("a").addClass(e),e?a.removeClass(t).addClass(t):a.removeClass(t)})}t.$observe("acTabStyle",i)}}}),angular.module("acComponents.filters").filter("acNormalizeForecastTitle",function(){return function(e){return e?e.replace(/^Avalanche (Forecast|Bulletin) - /g,""):void 0}}),angular.module("acComponents.filters").filter("dateUtc",function(){return function(e,a){return e?moment.utc(e).format(a):void 0}}).filter("dateformat",function(){return function(e){var a=moment(e,"YYYY-MM-DD hh:mm"),t=moment.parseZone(a).zone(),i={480:"P",420:"M",360:"C",300:"E",240:"A",180:"N"},n=a.isDST()?"DT":"ST",o="UTC";return t in i&&(o=i[t]+n,a.subtract(t,"minutes")),a.format("MMM Do, YYYY")}}),angular.module("acComponents.services").factory("acAvalancheReportData",["acFormUtils",function(e){var a={avalancheOccurrenceEpoch:{title:"Avalanche date/time:",prompt:"Avalanche date:",type:"datetime",showOnlyDate:!0,value:null,order:1,placeholder:"Click to select date (required)",subTitle:"If you triggered or witnessed an avalanche add date/time.",maxDateToday:!0},avalancheOccurrenceTime:{title:null,prompt:"Avalanche time:",type:"datetime",showOnlyTime:!0,value:null,order:1,placeholder:"Click to select time (optional)"},avalancheObservation:{title:null,subTitle:"If you observed evidence of recent avalanches, estimate occurrence time.",prompt:"Estimated occurrence time:",type:"radio",inline:!0,options:["12 hrs ago","12-24 hrs ago",">24-48 hrs ago",">48 hrs ago"],value:null,order:2},avalancheNumber:{prompt:"Number of avalanches in this report:",type:"radio",inline:!0,options:["1","2-5","6-10","11-50","51-100"],value:null,order:2},avalancheSize:{prompt:"Avalanche size:",type:"radio",inline:!0,value:null,options:["1","1.5","2","2.5","3","3.5","4","4.5","5"],helpText:"Use Canadian size classification. Size 1 is relatively harmless to people. Size 2 can bury, injure or kill a person. Size 3 can bury and destroy a car. Size 4 can destroy a railway car. Size 5 can destroy 40 hectares of forest.",order:3},slabThickness:{type:"number",prompt:"Slab thickness (cm):",value:null,options:{min:10,max:500},errorMessage:"Number between 10 and 500 please.",order:4},slabWidth:{type:"number",prompt:"Slab width (m):",value:null,options:{min:1,max:3e3},errorMessage:"Number between 1 and 3000 please.",order:5},runLength:{type:"number",prompt:"Run length (m):",options:{min:1,max:1e4},value:null,errorMessage:"Number between 1 and 10000 please.",helpText:"Length from crown to toe of debris.",order:6},avalancheCharacter:{type:"checkbox",prompt:"Avalanche character:",limit:3,inline:!0,options:{"Storm slab":!1,"Wind slab":!1,"Persistent slab":!1,"Deep persistent slab":!1,"Wet slab":!1,"Cornice only":!1,"Cornice with slab":!1,"Loose wet":!1,"Loose dry":!1},order:7,errorMessage:"Please check maximum 3 options."},triggerType:{type:"radio",prompt:"Trigger type:",inline:!0,options:["Natural","Skier","Snowmobile","Other vehicle","Helicopter","Explosives"],value:null,order:8},triggerSubtype:{type:"radio",prompt:"Trigger subtype:",value:null,inline:!0,options:["Accidental","Intentional","Remote"],helpText:"A remote trigger is when the avalanche starts some distance away from where the trigger was  applied.",order:9},triggerDistance:{type:"number",prompt:"Remote trigger distance (m):",options:{min:0,max:2e3},helpText:"If a remote trigger, enter how far from the trigger point is the nearest part of the crown.",value:null,errorMessage:"Number between 0 and 2000 please.",order:10},startZoneAspect:{type:"checkbox",inline:!0,prompt:"Start zone aspect:",options:{N:!1,NE:!1,E:!1,SE:!1,S:!1,SW:!1,W:!1,NW:!1},value:null,order:11,limit:3,errorMessage:"Please check maximum 3 options."},startZoneElevationBand:{prompt:"Start zone elevation band:",type:"checkbox",inline:!0,options:{Alpine:!1,Treeline:!1,"Below treeline":!1},value:null,order:12},startZoneElevation:{type:"number",prompt:"Start zone elevation (m):",options:{min:0,max:5e3},value:null,errorMessage:"Number between 0 and 5000 please.",order:13},startZoneIncline:{type:"number",prompt:"Start zone incline:",options:{min:0,max:90},value:null,errorMessage:"Number between 0 and 90 please.",order:14},runoutZoneElevation:{type:"number",prompt:"Runout zone elevation:",options:{min:0,max:5e3},placeholder:"Metres above sea level",helpText:"The lowest point of the debris.",value:null,errorMessage:"Number between 0 and 5000 please.",order:15},weakLayerBurialDate:{prompt:"Weak layer burial date:",type:"datetime",showOnlyDate:!0,helpText:"Date the weak layer was buried.",order:16,value:null,maxDateToday:!0},weakLayerCrystalType:{type:"checkbox",prompt:"Weak layer crystal type:",limit:2,inline:!0,options:{"Surface hoar":!1,Facets:!1,"Surface hoar and facets":!1,"Depth hoar":!1,"Storm snow":!1},order:17,errorMessage:"Please check maximum 2 options."},crustNearWeakLayer:{prompt:"Crust near weak layer:",type:"radio",inline:!0,options:["Yes","No"],value:null,order:18},windExposure:{type:"radio",prompt:"Wind exposure:",options:["Lee slope","Cross-loaded slope","Windward slope","Down flow","Reverse-loaded slope","No wind exposure"],value:null,inline:!0,order:19},vegetationCover:{type:"radio",prompt:"Vegetation cover:",value:null,inline:!0,options:["Open slope","Sparse trees or gladed slope","Dense trees"],order:20},avalancheObsComment:{prompt:"Avalanche observation comment",type:"textarea",value:null,helpText:"Please add additional information, for example terrain, aspect, elevation etc. especially if describing many avalanches together.",order:21}};return e.buildReport(a)}]),angular.module("acComponents.services").factory("acBreakpoint",["$rootScope","$timeout","$window",function(e,a,t){return{setBreakpoints:function(i){function n(){var n,l=$(t).width();n=l<i.xs?"xs":l>=i.xs&&l<i.sm?"sm":l>=i.sm&&l<i.md?"md":"lg",o&&n===o||(o=n,a(function(){e.$broadcast("breakpoint",o)},0))}var o;n(),angular.element(t).bind("resize",n)}}}]),angular.module("acComponents.services").factory("acForecast",["$http","$q","acImageCache","AC_API_ROOT_URL",function(e,a,t,i){var n,o=i;return{fetch:function(){var t=a.defer();return n?t.resolve(n):e.get(o+"/api/forecasts").then(function(e){n=e.data,t.resolve(n)}),t.promise},getOne:function(t){return a.when(this.fetch()).then(function(){var a=_.find(n.features,{id:t});return e.get(o+a.properties.forecastUrl).then(function(e){return e.data})})},getDangerIconUrl:function(e){var a=_.find(n.features,{id:e});return i+a.properties.dangerIconUrl}}}]),angular.module("acComponents.services").factory("acFormUtils",function(){function e(e){function a(e){return i[e.type]}function t(){return _.reduce(e,function(a,t,i){return a[i]="calculated"===t.type?n(t,e):t.getDTO(),a},{})}function n(e,a){return _.reduce(e.computeFields,function(e,t){return e+=a[t].value},0)}function o(){return _.reduce(e,function(e,a,t){var i=a.validate();return i||(e[t]=!0),e},{})}function l(){_.invoke(e,"reset")}function s(){var a=_.reduce(e,function(e,a){return e+=a.isCompleted()?1:0},0);return a>0}function r(a){if(!_.isEmpty(a)){var t=_.reduce(a,function(a,t,i){_.isUndefined(a[i])&&null!==t&&angular.isDefined(t)&&(a[i]={});var n=c(t);return angular.isDefined(t)&&null!==t&&!_.isEmpty(n.toString())&&(a[i]=e[i]?e[i].getDisplayObject():{},a[i].value=n),a},{});return _.sortBy(_.values(t),"order")}}function c(e){return _.isPlainObject(e)?_.reduce(e,function(e,a,t){return a&&e.push(t),e},[]):e}if(!angular.isDefined(e))throw new Error("Please provide fields");return _.forEach(e,function(e){_.assign(e,a(e))}),{fields:e,getDTO:t,validate:o,reset:l,isCompleted:s,mapDisplayResponse:r}}function a(e){try{if(-1===e.indexOf(","))return!1;var a=e.split(",");if(2!==a.length)return!1;var t=parseFloat(a[0]),i=parseFloat(a[1]);return!(isNaN(t)||isNaN(i))}catch(n){return!1}}var t={getDTO:function(){return this.value},validate:function(){return!0},reset:function(){this.value=null},isCompleted:function(){return!_.isEmpty(this.value)},getDisplayObject:function(){return{prompt:this.prompt,order:this.order?this.order:50,type:this.type}}},i={checkbox:{getDTO:function(){return this.options},validate:function(){if(angular.isDefined(this.limit)){var e=this.getNumberSelected();return e<=this.limit}return!0},reset:function(){var e=this.options;_.forEach(this.options,function(a,t){e[t]=!1})},isCompleted:function(){var e=this.getNumberSelected();return e>0},getNumberSelected:function(){return _.reduce(this.options,function(e,a){return a&&e++,e},0)},getDisplayObject:t.getDisplayObject},number:{getDTO:t.getDTO,validate:function(){return null==this.value||parseInt(this.value)>=this.options.min&&parseInt(this.value)<=this.options.max},reset:t.reset,isCompleted:function(){return null!==this.value},getDisplayObject:t.getDisplayObject},dropdown:t,textarea:t,radio:t,datetime:t,calculated:{getDTO:t.getDTO,validate:t.validate,reset:t.reset,isCompleted:function(){return!1},getDisplayObject:t.getDisplayObject},text:t};return{buildReport:e,validateLocationString:a}}),angular.module("acComponents.services").service("acHotZoneReportData",["acFormUtils",function(e){var a={persistentAvalancheProblem:{type:"radio",inline:!1,prompt:"Persistent avalanche problem:",options:["Yes","No","Unknown"],value:null,order:1},slabAvalanches:{type:"radio",inline:!0,prompt:"Slab avalanches in the last 48 hours:",options:["Yes","No","Unknown"],value:null,order:2},instability:{type:"radio",inline:!0,prompt:"Signs of instability:",options:["Yes","No","Unknown"],value:null,order:3},recentSnowfall:{type:"radio",inline:!0,prompt:"Recent snowfall > 30cm:",options:["Yes","No","Unknown"],value:null,order:4},recentRainfall:{type:"radio",inline:!0,prompt:"Recent rainfall:",options:["Yes","No","Unknown"],value:null,order:5},recentWindloading:{type:"radio",inline:!0,prompt:"Recent windloading:",options:["Yes","No","Unknown"],value:null,order:6},significantWarming:{type:"radio",inline:!0,prompt:"Significant warming:",options:["Yes","No","Unknown"],value:null,order:7},criticalFactorsComments:{prompt:"Critical factors comments:",type:"textarea",value:null,order:8}},t={aspect:{type:"checkbox",prompt:"Aspect:",options:{N:!1,NE:!1,E:!1,SE:!1,S:!1,SW:!1,W:!1,NW:!1,All:!1},inline:!0,order:1},elevationBand:{type:"checkbox",prompt:"Elevation band:",options:{Alpine:!1,Treeline:!1,"Below treeline":!1},inline:!0,order:2},elevationBelow:{type:"number",prompt:"Elevation below:",options:{min:0,max:5e3},value:null,errorMessage:"Number between 0 and 5000 please.",order:3},elevationAbove:{type:"number",prompt:"Elevation above:",options:{min:0,max:5e3},value:null,errorMessage:"Number between 0 and 5000 please.",order:4},elevationBetweenLow:{type:"number",prompt:"Elevation between:",options:{min:0,max:5e3},value:null,errorMessage:"Number between 0 and 5000 please.",order:5},elevationBetweenHigh:{type:"number",subTitle:"and",options:{min:0,max:5e3},value:null,errorMessage:"Number between 0 and 5000 please.",order:6},terrainFeatures:{type:"checkbox",prompt:"Terrain features:",options:{"Steeper than [enter number below]":!1,Convex:!1,Unsupported:!1,"Lee slopes":!1,"Crossloaded slopes":!1,"Shallow snowpack":!1,"Variable depth snowpack":!1,"Other [describe below]":!1},inline:!0,helpText:'Use input boxes below if "steeper than" and/or "other."',order:7},steeperThan:{title:null,type:"number",prompt:"Steeper than:",value:null,order:8,errorMessage:"Please enter steeper than value",options:{min:0,max:90},constraint:{field:"terrainFeatures",option:"Steeper than [enter number below]"}},otherTerrainFeatures:{title:null,type:"text",prompt:"Describe other terrain features",value:null,order:9,errorMessage:"Please describe what other terrain features.",constraint:{field:"terrainFeatures",option:"Other [describe below]"}},terrainAvoidanceComments:{prompt:"Terrain avoidance comments:",type:"textarea",value:null,order:10}},i={travelAdviceStatement1:{prompt:"Travel advice statement 1:",type:"textarea",value:null,order:1},travelAdviceStatement2:{prompt:"Travel advice statement 2:",type:"textarea",value:null,order:2},travelAdviceStatement3:{prompt:"Travel advice statement 3:",type:"textarea",value:null,order:3},travelAdviceComments:{prompt:"Travel advice comments:",type:"textarea",value:null,order:4}};
return{criticalFactors:e.buildReport(a),terrainAvoidanceList:e.buildReport(t),travelAdvice:e.buildReport(i)}}]),angular.module("acComponents.services").factory("acImageCache",["$http",function(e){return{cache:function(a){a.forEach(function(a){e.get(a)})}}}]),angular.module("acComponents.services").service("acIncidentReportData",["acFormUtils",function(e){var a={groupActivity:{type:"checkbox",prompt:"Activity:",options:{Snowmobiling:!1,Skiing:!1,"Climbing/Mountaineering":!1,"Hiking/Scrambling":!1,Snowshoeing:!1,Tobogganing:!1,Other:!1},inline:!0,helpText:"If other, please describe it below.",order:1},otherActivityDescription:{title:null,type:"text",prompt:"Describe other activity",value:null,order:2,errorMessage:"Please describe what other activity.",constraint:{field:"groupActivity",option:"Other"}},groupSize:{type:"number",title:"Group details:",prompt:"Total in the group?",subTitle:"Total in the group?",options:{min:0,max:100},value:null,errorMessage:"Number between 0 and 100 please.",order:3},numberFullyBuried:{type:"number",prompt:"People fully buried?",subTitle:"People fully buried?",options:{min:0,max:100},value:null,errorMessage:"Number between 0 and 100 please.",order:4},numberPartlyBuriedImpairedBreathing:{type:"number",prompt:"People partly buried with impaired breathing?",subTitle:"People partly buried with impaired breathing?",options:{min:0,max:100},value:null,errorMessage:"Number between 0 and 100 please.",order:5},numberPartlyBuriedAbleBreathing:{type:"number",prompt:"People partly buried with normal breathing?",subTitle:"People partly buried with normal breathing?",options:{min:0,max:100},value:null,errorMessage:"Number between 0 and 100 please.",order:6},numberCaughtOnly:{type:"number",prompt:"People injured (caught but not buried)?",subTitle:"People injured (caught but not buried)?",options:{min:0,max:100},value:null,errorMessage:"Number between 0 and 100 please.",order:7},numberPeopleInjured:{type:"number",prompt:"People not injured (caught but not buried)?",subTitle:"People not injured (caught but not buried)?",options:{min:0,max:400},value:null,errorMessage:"Number between 0 and 400 please.",order:8},terrainShapeTriggerPoint:{type:"radio",inline:!0,prompt:"Terrain shape at trigger point:",options:["Convex","Planar","Concave","Unsupported"],value:null,helpText:"Convex: a roll. Concave: bowl-shaped. Planar: smooth with no significant convexities or concavities. Unsupported: a slope that drops off abruptly at the bottom.",order:9},snowDepthTriggerPoint:{type:"radio",inline:!0,prompt:"Snow depth at trigger point:",options:["Shallow","Deep","Average","Variable"],helpText:"The depth of the snowpack compared to the average conditions in the area. Shallow: shallower than average. Deep: deeper than average. Average: about the same as everywhere else. Variable: depth varies significantly in the place where the avalanche started.",value:null,order:10},terrainTrap:{type:"checkbox",prompt:"Terrain trap:",options:{"No obvious terrain trap":!1,"Gully or depression":!1,"Slope transition or bench":!1,Trees:!1,Cliff:!1},inline:!0,helpText:"Terrain traps are features that increase the consequences of an avalanche.",order:11},incidentDescription:{prompt:"Incident description",type:"textarea",value:null,helpText:"No names and no judging please.",guidelines:"http://www.avalanche.ca/fxresources/Submissions+Guidelines.pdf",order:12},numberInvolved:{type:"calculated",value:0,computeFields:["numberFullyBuried","numberPartlyBuriedImpairedBreathing","numberPartlyBuriedAbleBreathing","numberCaughtOnly","numberPeopleInjured"]}};return e.buildReport(a)}]),angular.module("acComponents.services").factory("acObservation",["$http","AC_API_ROOT_URL",function(e,a){var t=a+"/api/min/observations";return{byPeriod:function(a){var i={params:{last:a||"2:days"}};return e.get(t,i).then(function(e){return e.data})},getOne:function(a,i){var i="."+i||"",n=t+"/"+a+i;return e.get(n).then(function(e){return e.data})}}}]),angular.module("acComponents.services").service("acQuickReportData",function(){function e(e){var a=[];return e.slab&&a.push("Slab avalanches today or yesterday."),e.sound&&a.push("Whumpfing or drum-like sounds or shooting cracks."),e.snow&&a.push("30cm + of new snow, or significant drifting, or rain in the last 48 hours."),e.temp&&a.push("Rapid temperature rise to near zero degrees or wet surface snow."),a}this.avalancheConditions={slab:!1,sound:!1,snow:!1,temp:!1},this.ridingConditions={ridingQuality:{prompt:"Riding quality was:",type:"single",options:["Amazing","Good","OK","Terrible"],selected:null},snowConditions:{type:"multiple",prompt:"Snow conditions were:",options:{Crusty:!1,Powder:!1,"Deep powder":!1,Wet:!1,Heavy:!1,"Wind affected":!1,Hard:!1}},rideType:{type:"multiple",prompt:"We rode:",options:{"Mellow slopes":!1,"Steep slopes":!1,"Convex slopes":!1,"Sunny slopes":!1,"Cut-blocks":!1,"Open trees":!1,"Dense trees":!1,"Alpine slopes":!1}},stayedAway:{type:"multiple",prompt:"We stayed away from:",options:{"Steep slopes":!1,"Convex slopes":!1,"Sunny slopes":!1,"Cut-blocks":!1,"Open trees":!1,"Alpine slopes":!1}},weather:{type:"multiple",prompt:"The day was:",options:{Stormy:!1,Windy:!1,Sunny:!1,Cold:!1,Warm:!1,Cloudy:!1,Foggy:!1,Wet:!1}}},this.comment=null,this.isCompleted=function(e){function a(e){return _.reduce(e,function(e,a){return e+a?1:0},0)}var t=a(e.avalancheConditions),i=_.reduce(e.ridingConditions,function(e,t){if("single"!==t.type||_.isEmpty(t.selected)){if("multiple"===t.type){var i=a(t.options);i>0&&e++}}else e++;return e},0),n=_.isEmpty(e.comment)?0:1;return t+i+n>0},this.mapDisplayResponse=function(a){var t=[];return a.avalancheConditions&&e(a.avalancheConditions).length>0&&t.push({prompt:"Avalanche conditions",type:"checkbox",order:2,value:e(a.avalancheConditions)}),_.forEach(a.ridingConditions,function(e){if("single"===e.type&&e.selected&&e.selected&&t.push({prompt:e.prompt,type:"radio",order:1,value:e.selected}),"multiple"===e.type&&e.options){var a=_.reduce(e.options,function(e,a,t){return a&&e.push(t),e},[]);_.isEmpty(a)||t.push({prompt:e.prompt,type:"checkbox",order:1,value:a})}}),a.comment&&t.push({type:"textarea",prompt:"Comment",value:a.comment,order:100}),t}}),angular.module("acComponents.services").factory("acReportData",["acQuickReportData","acAvalancheReportData","acSnowpackReportData","acWeatherReportData","acIncidentReportData","acHotZoneReportData",function(e,a,t,i,n,o){return{quick:e,avalanche:a,snowpack:t,weather:i,incident:n,hotzone:o}}]),angular.module("acComponents.services").factory("acSnowpackReportData",["acFormUtils",function(e){var a={snowpackObsType:{type:"radio",prompt:"Is this a point observation or a summary of your day?",options:["Point observation","Summary"],inline:!0,value:null,order:1},snowpackSiteElevation:{type:"number",prompt:"Elevation:",options:{min:0,max:4e3},placeholder:"Metres above sea level",value:null,errorMessage:"Number between 0 and 4000 please.",order:2},snowpackSiteElevationBand:{type:"checkbox",prompt:"Elevation band:",options:{Alpine:!1,Treeline:!1,"Below treeline":!1},inline:!0,value:null,order:3},snowpackSiteAspect:{type:"checkbox",prompt:"Aspect:",options:{N:!1,NE:!1,E:!1,SE:!1,S:!1,SW:!1,W:!1,NW:!1},value:null,inline:!0,order:4,limit:3,errorMessage:"Please check maximum 3 options."},snowpackDepth:{type:"number",prompt:"Snowpack depth (cm):",options:{min:0,max:1e4},helpText:"Total height of snow in centimetres. Averaged if this is a summary.",value:null,errorMessage:"Number between 0 and 10000 please.",order:5},snowpackWhumpfingObserved:{type:"radio",prompt:"Did you observe whumpfing?",options:["Yes","No"],inline:!0,value:null,helpText:"A whumpf is a rapid settlement of the snowpack caused by the collapse of a weak layer. It is accompanied by an audible noise.",order:6},snowpackCrackingObserved:{type:"radio",prompt:"Did you observe cracking?",options:["Yes","No"],inline:!0,value:null,helpText:"Cracking is shooting cracks radiating more than a couple of metres from your sled or skis.",order:7},snowpackSurfaceCondition:{type:"checkbox",prompt:"Surface condition:",options:{"New snow":!1,Crust:!1,"Surface hoar":!1,Facets:!1,Corn:!1,Variable:!1},inline:!0,order:8},snowpackFootPenetration:{type:"number",prompt:"Foot penetration (cm):",options:{min:0,max:200},helpText:"How far you sink into the snow when standing on one fully-weighted foot.",value:null,errorMessage:"Number between 0 and 200 please.",order:9},snowpackSkiPenetration:{type:"number",prompt:"Ski penetration (cm):",options:{min:0,max:200},helpText:"How far  you sink into the snow when standing on one fully-weighted ski.",value:null,errorMessage:"Number between 0 and 200 please.",order:10},snowpackSledPenetration:{type:"number",prompt:"Sled penetration (cm):",options:{min:0,max:200},helpText:"The depth a sled sinks into the snow after stopping slowly on level terrain.",value:null,errorMessage:"Number between 0 and 200 please.",order:11},snowpackTestInitiation:{type:"radio",prompt:"Snowpack test result:",options:["None","Very easy","Easy","Moderate","Hard"],helpText:"Average if you did a number of tests.",value:null,inline:!0,order:12},snowpackTestFracture:{type:"radio",prompt:"Snowpack test fracture character:",options:['Sudden ("pop" or "drop")',"Resistant","Uneven break"],helpText:"Average if you did a number of tests. Describe further in comments if variable results.",value:null,inline:!0,order:13},snowpackTestFailure:{type:"number",prompt:"Snowpack test failure depth:",options:{min:0,max:200},helpText:"Depth below the surface that failure occurred.",value:null,errorMessage:"Number between 0 and 200 please.",order:14},snowpackTestFailureLayerCrystalType:{type:"checkbox",prompt:"Snowpack test failure layer crystal type:",limit:2,options:{"Surface hoar":!1,Facets:!1,"Depth hoar":!1,"Storm snow":!1,Crust:!1,Other:!1},inline:!0,order:15,errorMessage:"Please check maximum 2 options."},snowpackObsComment:{type:"textarea",prompt:"Observation comment:",value:null,helpText:"Please add additional information about the snowpack, especially notes about weak layer, how the snow varied by aspect/elevation, and details of any slope testing performed.",order:16}};return e.buildReport(a)}]),angular.module("acComponents.services").factory("acSubmission",["$q","$http","AC_API_ROOT_URL",function(e,a,t){function i(e){return e.size<s&&-1!==r.indexOf(e.type)}function n(e){return _.reduce(e,function(e,a){return e&&i(a)},!0)}function o(a){var t=e.defer();if(n(a.files)){var i=_.reduce(a,function(e,a,t){return"files"===t?_.forEach(a,function(a,t){e.append("file"+t,a,a.name)}):_.isPlainObject(a)||_.isArray(a)?e.append(t,JSON.stringify(a)):"datetime"===t?e.append(t,moment(a,"YYYY-MM-DD hh:mm A").format()):_.isString(a)&&e.append(t,a),e},new FormData);t.resolve(i)}else t.reject(c);return t.promise}var l=t+"/api/min/submissions",s=25e6,r=["image/png","image/jpeg"],c="Invalid file! Files have to be smaller than 25 MB and of type: "+r.join(", ");return{submit:function(e,t){return o(e).then(function(e){return a.post(l,e,{transformRequest:angular.identity,headers:{"Content-Type":void 0,Authorization:"Bearer "+t}})})},byPeriod:function(e){var t={params:{period:e||"2:days"}};return a.get(l,t).then(function(e){return e.data})},getOne:function(e,t){var i=l+"/"+e;return a.get(i).then(function(e){return e.data})}}}]),angular.module("acComponents.services").factory("acWeatherReportData",["acFormUtils",function(e){var a={skyCondition:{type:"radio",prompt:"Cloud cover:",options:["Clear","Few clouds (<2/8)","Scattered clouds (2/8-4/8)","Broken clouds (5/8-7/8)","Overcast (8/8)","Fog"],inline:!0,helpText:"Values expressed in eighths refer to the proportion of the sky that was covered with clouds. E.g. 2/8 refers to a sky approximately one quarter covered with cloud.",order:1},precipitationType:{type:"radio",prompt:"Precipitation type:",options:["Snow","Rain","Mixed snow & rain","None"],value:null,inline:!0,order:2},snowfallRate:{type:"number",prompt:"Snowfall rate (cm/hour):",options:{min:1,max:20},value:null,helpText:"If there was no snow, please leave this field blank.",errorMessage:"Number between 1 and 20 please.",order:3},rainfallRate:{type:"radio",prompt:"Rainfall rate:",options:["Drizzle","Showers","Raining","Pouring"],value:null,inline:!0,helpText:"If there was no rain, please leave this field blank.",order:4},temperature:{type:"number",prompt:"Temperature at time of observation (deg C):",options:{min:-50,max:40},value:null,errorMessage:"Number between -50 and 40 please.",order:5},minTemp:{type:"number",prompt:"Minimum temperature in last 24 hours (deg C)",options:{min:-50,max:30},value:null,errorMessage:"Number between -50 and 30 please.",order:6},maxTemp:{type:"number",prompt:"Maximum temperature in last 24 hours (deg C):",options:{min:-40,max:40},value:null,errorMessage:"Number between -40 and 40 please.",order:7},temperatureTrend:{type:"radio",prompt:"Temperature trend:",options:["Falling","Steady","Rising"],value:null,inline:!0,helpText:"Describe how the temperature changed in the last 3 hours.",order:8},newSnow24Hours:{type:"number",prompt:"Amount of new snow in last 24 hours (cm):",options:{min:0,max:100},value:null,errorMessage:"Number between 0 and 100 please.",order:9},precipitation24Hours:{type:"number",prompt:"Total rain and snow combined in last 24 hours (mm):",options:{min:0,max:100},value:null,errorMessage:"Number between 0 and 100 please.",order:10},stormSnowAmount:{type:"number",prompt:"Total snow from the most recent storm (cm):",options:{min:0,max:300},value:null,helpText:"Please enter the amount of snow that has fallen during the current storm cycle. You can specify a storm start date to describe the time period over which this snow fell.",errorMessage:"Number between 0 and 300 please.",order:11},stormStartDate:{type:"datetime",prompt:"Storm start date:",showOnlyDate:!0,value:null,helpText:"The date on which the most recent storm started. Leave blank if there has not been a recent storm.",order:12,maxDateToday:!0},windSpeed:{type:"radio",prompt:"Wind speed:",options:["Calm","Light (1-25 km/h)","Moderate (26-40 km/h)","Strong (41-60 km/h)","Extreme (>60 km/h)"],value:null,inline:!0,helpText:"Calm: smoke rises. Light: flags and twigs move. Moderate: snow begins to drift. Strong: whole tress in motion. Extreme: difficulty walking.",order:13},windDirection:{type:"radio",prompt:"Wind direction:",options:["N","NE","E","SE","S","SW","W","NW"],inline:!0,value:null,order:14},blowingSnow:{type:"radio",prompt:"Blowing snow:",options:["None","Light","Moderate","Intense"],inline:!0,helpText:"How much snow is blowing at ridge crest elevation. Light: localized snow drifting. Moderate: a plume of snow is visible. Intense: a large plume moving snow well down the slope.",order:15,value:null},weatherObsComment:{type:"textarea",prompt:"Weather observation comment",value:null,order:16}};return e.buildReport(a)}]),angular.module("acComponents.templates",[]).run(["$templateCache",function(e){e.put("allmin-icon.html",'<svg width="28px" height="28px" viewbox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>all_min</title><g id="Styleguide" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="02_01_Second-proposal-#2" sketch:type="MSArtboardGroup" transform="translate(-30.000000, -101.000000)" stroke="#FFFFFF"><g id="all_min" sketch:type="MSLayerGroup" transform="translate(31.000000, 102.000000)"><circle id="Oval-6" fill="#FFFFFF" sketch:type="MSShapeGroup" cx="13" cy="13" r="13"></circle><path id="Oval-5" d="M20.6424365,23.5174622 C18.4973383,25.078868 15.8562401,26 13,26 C10.1408573,26 7.49729401,25.0769949 5.35102528,23.5126999 C5.35616485,23.5157039 5.35879172,23.5172209 5.35879172,23.5172209 L12.9999995,13 L20.6412083,23.5172209 C20.6412083,23.5172209 20.6416198,23.5173052 20.6424365,23.5174622 Z" fill="#F44336" sketch:type="MSShapeGroup"></path><path id="Oval-1" d="M13,0 C7.1843333,0 2.26060446,3.81883989 0.599648246,9.08568486 C0.623290506,9.01855468 0.636265288,8.98277907 0.636265288,8.98277907 L12.9999995,13 L13,0 Z" fill="#03A9F4" sketch:type="MSShapeGroup"></path><path id="Oval-1" d="M13,0 C18.8156667,0 23.7393955,3.81883989 25.4003518,9.08568486 C25.3767095,9.01855468 25.3637347,8.98277907 25.3637347,8.98277907 L13.0000005,13 L13,0 Z" fill="#3F51B5" sketch:type="MSShapeGroup"></path><path id="Oval-3" d="M7.63867216,23.5467443 C10.8878189,21.1834812 13.0000005,17.3516752 13.0000005,13.0265428 C13.0000005,11.6211191 12.7769788,10.2677848 12.3643955,9 L12.3637352,9.00932187 L0,13.0265428 L7.64120875,23.5437637 C7.64120875,23.5437637 7.64035873,23.5447686 7.63867216,23.5467443 Z" fill="#4CAF50" sketch:type="MSShapeGroup" transform="translate(6.500000, 16.273372) scale(-1, 1) translate(-6.500000, -16.273372) "></path><path id="Oval-3" d="M20.6386717,23.5202015 C23.8878184,21.1569384 26,17.3251324 26,13 C26,11.5945763 25.7769784,10.241242 25.364395,8.97345721 L25.3637347,8.98277907 L12.9999995,13 L20.6412083,23.5172209 C20.6412083,23.5172209 20.6403583,23.5182258 20.6386717,23.5202015 Z" fill="#FFC107" sketch:type="MSShapeGroup"></path></g></g></g></svg>'),e.put("danger-icon.html",'<div class="danger-icon"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="398.5 12.1 555 560" enable-background="new 398.5 12.1 555 560" xml:space="preserve"><polygon id="alp" points="747.7,218.1 623.1,197.6 678.8,109.8"></polygon><polygon id="tln" points="794.2,291 542.8,323.6 616.7,207.4 755.5,230.3"></polygon><polygon id="btl" points="858.3,391.8 499.4,391.8 535.1,335.5 800.6,301.1"></polygon></svg><span>FORECAST</span></div>'),e.put("drawer.html",'<div class="ac-drawer"><a ng-click="drawer.right.visible = false" ng-if="drawerPosition === \'right\'" class="ac-drawer-close visible-xs"><i class="fa fa-close fa-lg"></i></a><div class="ac-drawer-tools"><ul><li ng-if="drawerPosition === \'right\'" ng-click="goToHotZoneReport()" class="ac-submit-report-tab on"><i class="fa fa-plus fa-2x"></i><i class="fa fa-exclamation-triangle fa-inverse fa-2x"></i><span>New hot zone report</span></li><li ng-if="drawerPosition === \'right\'" ng-click="toggleForecast()" ng-class="{on: drawer.right.visible &amp;&amp; drawer.right.enabled &amp;&amp; current.region.feature.properties.type === \'hotzone\'}" class="ac-report-tab"><i class="fa fa-exclamation-triangle fa-inverse fa-2x"></i><span>Hot Zone Report</span></li><li ng-if="drawerPosition === \'right\'" ng-click="toggleForecast()" ng-class="{on: drawer.right.visible &amp;&amp; drawer.right.enabled &amp;&amp; current.region.feature.properties.type !== \'hotzone\'}" style="margin-bottom: 50px;"><div ac-danger-icon="ac-danger-icon" style="height: 60px; width:60px;"></div></li><li ng-if="drawerPosition === \'left\'" ng-click="goToSubmitReport()" class="ac-submit-report-tab on"><i class="fa fa-plus fa-2x"></i><i class="fa fa-tasks fa-inverse fa-2x"></i><span>Create report</span></li><li ng-if="drawerPosition === \'left\'" class="ac-filters ac-min-filters"><ul ng-init="expandedMin = false" ng-class="{opened: expandedMin}" class="list-inline"><li ng-click="expandedMin = !expandedMin" class="ac-default-button on"><i class="fa fa-map-marker fa-inverse fa-2x"></i><span>MIN Filters</span></li><li ng-repeat="minFilter in minFilters" ng-if="expandedMin" ng-click="toggleFilter(\'minFilter:\'+ minFilter)" ng-class="{on: getMinFilters(minFilter)}"><div ac-allmin-icon="ac-allmin-icon" ng-if="minFilter === \'all min\'" class="report-allmin"></div><i ng-class="\'report-\'+ minFilter" ng-if="minFilter !== \'all min\'" class="fa fa-map-marker fa-inverse fa-2x"></i><span ng-class="{\'no-top\': minFilter == \'all min\' }">{{ minFilter }}</span></li></ul></li><li ng-if="drawerPosition === \'left\'" class="ac-filters ac-default-filters"><ul ng-class="{opened: expandedDate}" class="list-inline"><li ng-click="toggleDateFilters()" class="ac-default-button on"><i class="fa fa-calendar fa-inverse fa-2x"></i><span>Date filter</span></li><li ng-repeat="dateFilter in dateFilters" ng-if="expandedDate" ng-click="toggleFilter(\'obsPeriod:\'+dateFilter);" ng-class="{on: filters.obsPeriod === dateFilter}"><i class="fa fa-calendar fa-inverse fa-2x"></i><span>{{ dateFilter }}</span></li></ul></li><!--Previous behaviour where date filter selected is visible--><!--li.ac-filters.ac-date-filters(ng-if="drawerPosition === \'left\'")--><!--  ul.list-inline(ng-class="{opened: expandedDate}")--><!--    li.on(ng-click="toggleDateFilters()")--><!--      i.fa.fa-calendar.fa-inverse.fa-2x--><!--      span {{ filters.obsPeriod }}--><!--    li(ng-repeat="dateFilter in dateFilters", ng-if="expandedDate", ng-click="toggleFilter(\'obsPeriod:\'+dateFilter);", ng-class="{hidden: filters.obsPeriod === dateFilter}")--><!--      i.fa.fa-calendar.fa-inverse.fa-2x--><!--      span {{ dateFilter }}--></ul></div><div ng-transclude="ng-transclude" class="ac-drawer-body"></div></div>'),e.put("forecast-mini-avalx.html",'<div class="panel-body ac-forecast-mini-body"><div class="row"><div class="col-xs-6"><h4 class="ac-forecast-region">{{ forecast.bulletinTitle | acNormalizeForecastTitle }}</h4></div><div ng-switch="forecast.region"><div ng-switch-when="kananaskis" class="col-xs-6"><a target="_blank" href="" class="pull-right"><img style="width:75px;" src="http://www.avalanche.ca/assets/images/kananaskis.jpg"/></a></div><div ng-switch-when="whistler-blackcomb" class="col-xs-6 ac-forcast-mini--wbc-logo"><div class="logo-row">\n  <img class="wbc-logo" src="https://res.cloudinary.com/avalanche-ca/image/upload/c_scale,w_190/v1447367526/logos/OriginalSizeLogos/WBWhoosh_RedBlack.png" />\n</div>\n<div class="logo-row">\n  <img class="xc-logo" src="https://res.cloudinary.com/avalanche-ca/image/upload/c_scale,w_55/v1447367393/logos/OriginalSizeLogos/EC_black.png" />\n  <img class="whs-logo" src="https://res.cloudinary.com/avalanche-ca/image/upload/c_scale,w_136/v1447367393/logos/OriginalSizeLogos/Whistler_HeliSki_Logo.png"/>\n</div>\n</div><div ng-switch-default="ng-switch-default" class="col-xs-6"><a target="_blank" href="{{sponsor.getText(&quot;sponsor.url&quot;)}}" class="pull-right"><img src="{{sponsor.getText(&quot;sponsor.image-229&quot;)}}"/></a></div></div></div><div class="row ac-forecast-dates"><div class="col-md-6"><dl><dd class="small"><strong class="ac-text-primary">DATE ISSUED</strong></dd><dt class="small"><span class="ac-text-default">{{ forecast.dateIssued | date:\'EEEE MMMM d, y h:mm a\'  | uppercase }}</span></dt></dl></div><div class="col-md-6"><dl><dd class="small"><strong class="ac-text-primary">VALID UNTIL</strong></dd><dt class="small"><span class="ac-text-default">{{ forecast.validUntil | date:\'EEEE MMMM d, y h:mm a\' | uppercase }}</span></dt></dl></div></div><div class="row"><div class="col-xs-12"><p class="ac-forecast-highlights"><strong ng-bind-html="forecast.highlights"></strong></p></div></div><div class="row"><div style="padding-right:0" class="col-xs-12 observation-tabs"><ul role="tablist" style="text-transform: uppercase;" class="nav nav-pills"><li class="active"><a href="" role="tab" data-target="#forecast" data-toggle="tab">Forecast</a></li><li><a href="" role="tab" data-target="#problems" data-toggle="tab">Problems</a></li><li><a href="" role="tab" data-target="#details" data-toggle="tab">Details</a></li><li><a href="/forecasts/{{forecast.region}}" role="tab">Full Page</a></li><li><a href="/weather" role="tab">Weather</a></li></ul><div class="tab-content"><div id="forecast" class="tab-pane active"><div class="row"><div class="col-xs-12"><div class="panel panel-primary"><div class="panel-heading">{{ forecast.dangerRatings[0].date | dateUtc:\'dddd\' }}</div><div class="panel-body ac-forecast-nowcast"><img ng-show="forecast.region" ng-src="{{forecast.region &amp;&amp; apiUrl+\'/api/forecasts/\' + forecast.region  + \'/nowcast.svg\' || \'\'}}" class="ac-nowcast"/></div><table class="table table-condensed ac-forecast-days"><thead class="ac-thead-dark"><tr><th></th><th>{{ forecast.dangerRatings[1].date | dateUtc:\'dddd\' }}</th><th>{{ forecast.dangerRatings[2].date | dateUtc:\'dddd\' }}</th></tr></thead><tbody><tr><td class="ac-veg-zone--alp"><strong>Alpine</strong></td><td class="ac-danger-rating--{{ forecast.dangerRatings[1].dangerRating.alp.split(\':\')[1].toLowerCase()}}"><strong>{{ forecast.dangerRatings[1].dangerRating.alp.replace(\':\', \' \') }}</strong></td><td class="ac-danger-rating--{{ forecast.dangerRatings[2].dangerRating.alp.split(\':\')[1].toLowerCase()}}"><strong>{{ forecast.dangerRatings[2].dangerRating.alp.replace(\':\', \' \') }}</strong></td></tr><tr><td class="ac-veg-zone--tln"><strong>Treeline</strong></td><td class="ac-danger-rating--{{ forecast.dangerRatings[1].dangerRating.tln.split(\':\')[1].toLowerCase()}}"><strong>{{ forecast.dangerRatings[1].dangerRating.tln.replace(\':\', \' \') }}</strong></td><td class="ac-danger-rating--{{ forecast.dangerRatings[2].dangerRating.tln.split(\':\')[1].toLowerCase()}}"><strong>{{ forecast.dangerRatings[2].dangerRating.tln.replace(\':\', \' \') }}</strong></td></tr><tr><td class="ac-veg-zone--btl"><strong>Below Treeline</strong></td><td class="ac-danger-rating--{{ forecast.dangerRatings[1].dangerRating.btl.split(\':\')[1].toLowerCase()}}"><strong>{{ forecast.dangerRatings[1].dangerRating.btl.replace(\':\', \' \') }}</strong></td><td class="ac-danger-rating--{{ forecast.dangerRatings[2].dangerRating.btl.split(\':\')[1].toLowerCase()}}"><strong>{{ forecast.dangerRatings[2].dangerRating.btl.replace(\':\', \' \') }}</strong></td></tr><tr><td><strong>Confidence:</strong></td><td colspan="2"><span class="ac-text-default">{{ forecast.confidence }}</span></td></tr></tbody></table><footer id="forecast-bulletin" class="col-xs-12"></footer><div class="panel-group"><div ng-switch="forecast.region"><div ng-switch-when="whistler-blackcomb"><whistler-links></whistler-links></div><div ng-switch-default="ng-switch-default"><div class="panel panel-default first"><h4 class="panel-title"><a href="" data-target="#collapseTwo" data-parent="#accordion" data-toggle="collapse" class="collapsed">{{dangerRating.getText(\'generic.title\')}}</a></h4><div id="collapseTwo" class="collapse"><div ng-bind-html="dangerRating.getStructuredText(\'generic.body\').asHtml(ctx)" class="panel-body"></div></div></div><div class="panel panel-default last"><h4 class="panel-title"><a href="" data-target="#collapseOne" data-parent="#accordion" data-toggle="collapse" class="collapsed">{{disclaimer.getText(\'generic.title\')}}</a></h4><div id="collapseOne" class="collapse"><div ng-bind-html="disclaimer.getStructuredText(\'generic.body\').asHtml(ctx)" class="panel-body"></div></div></div></div></div></div></div></div></div></div><div id="problems" class="tab-pane"><div id="problemsAccordion" class="panel-group"><div ng-repeat="problem in forecast.problems" class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#problem{{$index}}" data-toggle="collapse" data-parent="#problemsAccordion">{{ problem.type }}<i class="fa fa-fw fa-level-down pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="problem{{$index}}" class="panel-collapse collapse"><div class="panel-body"><div class="row"><div class="col-md-6"><div class="panel panel-default"><div class="panel-heading"><strong class="small">What Elevations?</strong></div><div class="panel-body ac-problem-icon ac-problem-icon--elevations"><img ng-src="{{problem.icons.elevations}}" class="center-block"/></div></div></div><div class="col-md-6"><div class="panel panel-default"><div class="panel-heading"><strong class="small">What Aspects?</strong></div><div class="panel-body ac-problem-icon ac-problem-icon--aspects"><img ng-src="{{problem.icons.aspects}}" class="center-block"/></div></div></div></div><div class="row"><div class="col-md-6"><div class="panel panel-default"><div class="panel-heading"><strong class="small">Chances of Avalanches?</strong></div><div class="panel-body ac-problem-icon ac-problem-icon--likelihood"><img ng-src="{{problem.icons.likelihood}}" class="center-block"/></div></div></div><div class="col-md-6"><div class="panel panel-default"><div class="panel-heading"><strong class="small">Expected Size?</strong></div><div class="panel-body ac-problem-icon ac-problem-icon--expected-size"><img ng-src="{{problem.icons.expectedSize}}" class="center-block"/></div></div></div></div><div class="row"><div class="col-md-12"><p ng-bind-html="problem.comment" class="ac-problem narative"></p><div class="panel panel-default ac-problem-travel-advice"><div class="panel-heading"><strong class="small">Travel and Terrain Advice</strong></div><div class="panel-body"><p ng-bind-html="problem.travelAndTerrainAdvice"></p></div></div></div></div></div></div></div></div></div><div id="details" class="tab-pane"><div id="detailsAccordion" class="panel-group"><div class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#avalancheSummary" data-toggle="collapse" data-parent="#detailsAccordion">Avalanche Summary<i class="fa fa-fw fa-level-down fa-lg pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="avalancheSummary" class="panel-collapse collapse"><div ng-bind-html="forecast.avalancheSummary" class="panel-body"></div></div></div><div class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#snowpackSummary" data-toggle="collapse" data-parent="#detailsAccordion">Snowpack Summary<i class="fa fa-fw fa-level-down fa-lg pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="snowpackSummary" class="panel-collapse collapse"><div ng-bind-html="forecast.snowpackSummary" class="panel-body"></div></div></div><div class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#weatherForecast" data-toggle="collapse" data-parent="#detailsAccordion">Weather Forecast<i class="fa fa-fw fa-level-down fa-lg pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="weatherForecast" class="panel-collapse collapse"><div ng-bind-html="forecast.weatherForecast" class="panel-body"></div></div></div></div></div></div></div></div></div>'),e.put("forecast-mini-external.html",'<div style="min-height: 500px;" class="panel-body"><div class="row"><div class="col-xs-12"><h3 class="ac-forecast-region">{{ forecast.name }}</h3></div></div><div class="row"><div class="col-xs-12"><p>Avalanche information for this region is available &nbsp;<a ng-href="{{forecast.externalUrl}}" target="_blank"><i class="fa fa-external-link">here.</i></a></p></div></div></div>'),e.put("forecast-mini-parks.html",'<div style="min-height: 500px;" class="panel-body"><div class="row"><div class="col-xs-12"><h3 class="ac-forecast-region">{{ forecast.name }}</h3></div></div><div class="row"><div class="col-xs-12"><p>Avalanche information for this region is available &nbsp;<a ng-href="{{forecast.parksUrl}}" target="_blank"><i class="fa fa-external-link">here.</i></a></p></div></div></div>'),e.put("forecast-mini.html","<div class=\"panel\"><div ng-show=\"forecast.externalUrl\"><ac-forecast-mini-external forecast='forecast' /></div><div ng-show=\"forecast.parksUrl\"><ac-forecast-mini-parks forecast='forecast' /></div><div ng-hide=\"forecast.externalUrl || forecast.parksUrl\"><ac-forecast-mini-avalx forecast='forecast' danger-rating='dangerRating' disclaimer='disclaimer' sponsor='sponsor' /></div></div>"),e.put("hot-zone-mini.html",'<div class="panel"><div class="panel-body ac-forecast-mini-body"><div class="row"><div class="col-xs-12"><h3 class="ac-hot-zone-headline">Headline Goes Here</h3></div></div><div class="row"><div class="col-xs-12"><h4 class="ac-hot-zone-headline">REGION</h4></div></div><div class="row ac-forecast-dates"><div class="col-md-6"><dl><dd class="small"><strong class="ac-text-primary">DATE ISSUED</strong></dd><dt class="small"><span class="ac-text-default">{{ hotZone.dateIssued | date:\'EEEE MMMM d, y h:mm a\'  | uppercase }}</span></dt></dl></div><div class="col-md-6"><dl><dd class="small"><strong class="ac-text-primary">VALID UNTIL</strong></dd><dt class="small"><span class="ac-text-default">{{ hotZone.validUntil | date:\'EEEE MMMM d, y h:mm a\' | uppercase }}</span></dt></dl></div></div><div class="row"><div class="col-xs-12"><div id="infoAccordion" class="panel-group"><div class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#criticalSummary" data-toggle="collapse" data-parent="#infoAccordion">Critical Factors Summary<i class="fa fa-fw fa-level-down fa-lg pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="criticalSummary" class="panel-collapse collapse"><div class="panel-body"><div class="row"><div class="col-xs-12">Critical factors influence avalanche hazard. The more critical factors, the greater the potential for avalanches.</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Persistent Avalanche Problem:</strong></div><div class="col-xs-6">Yes</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Slab avalanches in the last 48 hours:</strong></div><div class="col-xs-6">Yes</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Signs of instability:</strong></div><div class="col-xs-6">Unknown</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right"> Recent snowfall > 30cm:</strong></div><div class="col-xs-6">No</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right"> Recent rainfall:</strong></div><div class="col-xs-6">No</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right"> Recent windloading:</strong></div><div class="col-xs-6">Yes</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right"> Significant warming:</strong></div><div class="col-xs-6">Unknown</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Comments:</strong></div><div class="col-xs-6">More information about conditions would be helpful. If you are riding in this area, please submit to the MIN.</div></div></div></div></div><div class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#terrainSummary" data-toggle="collapse" data-parent="#infoAccordion">Terrain Recommendations<i class="fa fa-fw fa-level-down fa-lg pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="terrainSummary" class="panel-collapse collapse"><div class="panel-body"><div class="row"><div class="col-xs-12">Based on the critical factors, AVOIDING the following is recommended to reduce risk.</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Aspect:</strong></div><div class="col-xs-6">N, NE, E</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Elevation band:</strong></div><div class="col-xs-6">Alpine, Treeline</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Elevation below:</strong></div><div class="col-xs-6">N/A</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Elevation above:</strong></div><div class="col-xs-6">N/A</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Elevation between:</strong></div><div class="col-xs-6">1800 and 3000 metres</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Slopes steeper than:</strong></div><div class="col-xs-6">35 degrees</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Terrain features:</strong></div><div class="col-xs-6">Convex, Unsupported, Lee slopes, Text from "Other" terrain features comment box.</div></div><div class="row"><div class="col-xs-6"><strong class="pull-right text-right">Comments:</strong></div><div class="col-xs-6">Text from terrain avoidance comments box.</div></div></div></div></div><div class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#travelSummary" data-toggle="collapse" data-parent="#infoAccordion">Travel Advice<i class="fa fa-fw fa-level-down fa-lg pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="travelSummary" class="panel-collapse collapse"><div class="panel-body"><p>Text from travel advice statement 1 text box</p><p>Text from travel advice statement 2 text box</p><p>Text from travel advice statement 3 text box</p><p>Text from travel advice comments text box.</p></div></div></div><div style="margin-bottom: 10px;" class="panel panel-primary"><div class="panel-heading"><h4 class="panel-title"><a href="" data-target="#infoSummary" data-toggle="collapse" data-parent="#infoAccordion">About<i class="fa fa-fw fa-level-down fa-lg pull-right"></i><small class="pull-right">click to expand</small></a></h4></div><div id="infoSummary" class="panel-collapse collapse"><div ng-bind-html="hotZone.infoSummary" class="panel-body"></div></div></div></div></div></div></div></div>'),e.put("hot-zone-report-form.html",'<div class="min-form"><form name="acHotZoneForm" novalidate="novalidate" ng-if="!report.subid" role="form" ac-submission-form-validator="ac-submission-form-validator"><div class="form-fields col-xs-12 no-padding"><div class="col-xs-12 col-md-4 form-left-column"><div class="required-info clearfix"><h3 class="form-subtitle">Step 1. Required Info</h3><div class="required-info-data col-xs-12"><div ng-class="{\'has-error\': !acHotZoneForm.title.$valid &amp;&amp; acHotZoneForm.title.$dirty }" class="form-group"><h4>Headline</h4><input type="text" name="title" ng-model="report.headline" placeholder="e.g. two - three sentences" required="required" class="form-control"/></div><div ng-class="{\'has-error\': !acHotZoneForm.dateissue.$valid}" class="form-group"><h4> Date of issue</h4><input type="datetime" name="dateissue" ng-model="report.dateissue" ac-datetime-picker="ac-datetime-picker" max-date-today="true" class="form-control"/></div><div ng-class="{\'has-error\': !acHotZoneForm.datevalid.$valid}" class="form-group"><h4> Valid until</h4><input type="datetime" name="datevalid" ng-model="report.datevalid" ac-datetime-picker="ac-datetime-picker" max-date-today="false" class="form-control"/></div><div ng-class="{\'has-error\': invalidLocation}" class="form-group"><h4> Location</h4><div ng-repeat="option in locations" style="margin-top: 10px;" class="radio col-md-6 col-xs-12"><label style="color: black;"><input type="radio" ng-model="report.location" value="{{ ::option}}"/>{{ ::option}}</label></div></div></div></div><div class="uploads"><h3 class="form-subtitle">Step 2. Uploads</h3><p>Add a photo (.jpg or .png).</p><div class="help-text"><p><i class="fa fa-question-circle"></i>If uploading more than one photo, select all and submit photos together.</p></div><div class="form-group"><div class="col-xs-12 no-padding btn-file"><div class="col-xs-3 no-padding"><span class="btn btn-default btn-styled">Browse</span></div><input type="text" readonly="readonly" placeholder=".jpg or .png" value="{{ report.files.length ? report.files.length + \' photos added\' : null}}" class="col-xs-9 no-padding"/><input type="file" name="uploads" file-model="report.files" accept=".png,.jpg,.jpeg" multiple="multiple"/></div></div></div></div><div class="col-xs-12 col-md-8 form-right-column"><div class="row"><div class="col-xs-12"><h3 id="top" class="form-subtitle">Step 3. Report Details</h3></div></div><div class="row"><div class="col-xs-12"><h4 class="form-subsection">Critical Factors Summary</h4></div></div><div style="margin: 0;" class="fields-group col-xs-12 no-padding"><div ng-repeat="(item, av) in report.obs.criticalFactors.fields" ng-if="av.type!==\'calculated\'" class="field col-xs-12"><h4 ng-if="av.title === undefined &amp;&amp; av.subTitle === undefined" class="field-title col-xs-12 no-padding"><strong>{{ ::av.prompt }}</strong></h4><h4 ng-if="av.title !== undefined &amp;&amp; av.title !== null" class="field-title col-xs-12 no-padding"><strong>{{ ::av.title }}</strong></h4><h5 ng-if="av.subTitle !== undefined" class="col-xs-12 no-padding">{{ ::av.subTitle }}</h5><div class="options col-xs-12 col-md-8"><div ng-if="av.helpText" class="help-text"><p><i class="fa fa-question-circle"></i><span>{{ ::av.helpText}}</span><span ng-if="av.guidelines"><a href="{{ ::av.guidelines}}" target="_blank">Submission guidelines</a></span></p></div><div ng-if="av.type==\'checkbox\'" ng-repeat="(option, enabled) in av.options" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="checkbox col-md-6 col-xs-12"><label><input type="checkbox" name="{{::item}}" ng-model="av.options[option]" ng-click="validate(item, av)"/>{{ ::option}}</label></div><div ng-if="av.type==\'radio\'" ng-repeat="option in av.options" ng-class="{\'inline\':av.inline}" style="margin: 0;" class="radio col-md-12 col-xs-12"><label><input type="radio" ng-model="report.obs.criticalFactors.fields[item].value" value="{{ ::option}}"/>{{ ::option}}</label></div><div ng-if="av.type==\'number\'" ng-class="{\'inline\':av.inline}" class="number col-xs-12"><label><input type="number" name="{{::item}}" placeholder="{{ av.placeholder ? av.placeholder : \'Number between \'+ av.options.min +\' and \'+av.options.max }}" ng-model="report.obs.criticalFactors.fields[item].value" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'text\'" ng-class="{\'inline\':av.inline}" class="text col-xs-12"><label><input type="text" name="{{::item}}" placeholder="{{ ::av.prompt }}" ng-model="report.obs.criticalFactors.fields[item].value" ng-required="report.obs.criticalFactors.fields[av.constraint.field].options[av.constraint.option]" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'dropdown\'" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="select col-md-6 col-xs-12 no-padding"><select ng-options="option for option in av.options" ng-model="report.obs.criticalFactors.fields[item].value" class="form-control"><option value="">Select option</option></select></div><div ng-if="av.type==\'textarea\'" class="textarea col-xs-12"><textarea rows="3" ng-model="report.obs.criticalFactors.fields[item].value" class="form-control"></textarea></div><div ng-if="av.type==\'datetime\'" class="datetime-input col-xs-12"><label for="datetime"><input type="datetime" ng-model="report.obs.criticalFactors.fields[item].value" ac-datetime-picker="ac-datetime-picker" show-only-date="av.showOnlyDate" show-only-time="av.showOnlyTime" max-date-today="av.maxDateToday" placeholder="{{av.placeholder ? av.placeholder : \'Click to select date\'}}" class="form-control"/></label></div><div ng-if="acHotZoneForm[item].$invalid" class="error col-xs-12 no-padding">{{::av.errorMessage}}</div></div><div class="options col-xs-12 col-md-4"></div></div></div><div class="row"><div class="col-xs-12"><h4 class="form-subsection">Terrain Avoidance List</h4></div></div><div style="margin: 0;" class="fields-group col-xs-12 no-padding"><div ng-repeat="(item, av) in report.obs.terrainAvoidanceList.fields" ng-if="av.type!==\'calculated\'" class="field col-xs-12"><h4 ng-if="av.title === undefined &amp;&amp; av.subTitle === undefined" class="field-title col-xs-12 no-padding"><strong>{{ ::av.prompt }}</strong></h4><h4 ng-if="av.title !== undefined &amp;&amp; av.title !== null" class="field-title col-xs-12 no-padding"><strong>{{ ::av.title }}</strong></h4><h5 ng-if="av.subTitle !== undefined" class="col-xs-12 no-padding">{{ ::av.subTitle }}</h5><div class="options col-xs-12 col-md-8"><div ng-if="av.helpText" class="help-text"><p><i class="fa fa-question-circle"></i><span>{{ ::av.helpText}}</span><span ng-if="av.guidelines"><a href="{{ ::av.guidelines}}" target="_blank">Submission guidelines</a></span></p></div><div ng-if="av.type==\'checkbox\'" ng-repeat="(option, enabled) in av.options" ng-class="{\'inline\':av.inline, \'column-left\':$odd, \'col-md-12\': av.prompt===\'Elevation band:\'}" ng-style="av.prompt===\'Elevation band:\' &amp;&amp; {\'margin\': \'0\'}" class="checkbox col-md-6 col-xs-12"><label><input type="checkbox" name="{{::item}}" ng-model="av.options[option]" ng-click="validate(item, av)"/>{{ ::option}}</label></div><div ng-if="av.type==\'radio\'" ng-repeat="option in av.options" ng-class="{\'inline\':av.inline}" style="margin-top: 0;" class="radio col-md-12 col-xs-12"><label><input type="radio" ng-model="report.obs.terrainAvoidanceList.fields[item].value" value="{{ ::option}}"/>{{ ::option}}</label></div><div ng-if="av.type==\'number\'" ng-class="{\'inline\':av.inline}" class="number col-xs-12"><label><input type="number" name="{{::item}}" placeholder="{{ av.placeholder ? av.placeholder : \'Number between \'+ av.options.min +\' and \'+av.options.max }}" ng-model="report.obs.terrainAvoidanceList.fields[item].value" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'text\'" ng-class="{\'inline\':av.inline}" class="text col-xs-12"><label><input type="text" name="{{::item}}" placeholder="{{ ::av.prompt }}" ng-model="report.obs.terrainAvoidanceList.fields[item].value" ng-required="report.obs.terrainAvoidanceList.fields[av.constraint.field].options[av.constraint.option]" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'dropdown\'" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="select col-md-6 col-xs-12 no-padding"><select ng-options="option for option in av.options" ng-model="report.obs.terrainAvoidanceList.fields[item].value" class="form-control"><option value="">Select option</option></select></div><div ng-if="av.type==\'textarea\'" class="textarea col-xs-12"><textarea rows="3" ng-model="report.obs.terrainAvoidanceList.fields[item].value" class="form-control"></textarea></div><div ng-if="av.type==\'datetime\'" class="datetime-input col-xs-12"><label for="datetime"><input type="datetime" ng-model="report.obs.terrainAvoidanceList.fields[item].value" ac-datetime-picker="ac-datetime-picker" show-only-date="av.showOnlyDate" show-only-time="av.showOnlyTime" max-date-today="av.maxDateToday" placeholder="{{av.placeholder ? av.placeholder : \'Click to select date\'}}" class="form-control"/></label></div><div ng-if="acHotZoneForm[item].$invalid" class="error col-xs-12 no-padding">{{::av.errorMessage}}</div></div><div class="options col-xs-12 col-md-4"></div></div></div><div class="row"><div class="col-xs-12"><h4 class="form-subsection">Travel Advice</h4></div></div><div style="margin: 0;" class="fields-group col-xs-12 no-padding"><div ng-repeat="(item, av) in report.obs.travelAdvice.fields" ng-if="av.type!==\'calculated\'" class="field col-xs-12"><h4 ng-if="av.title === undefined &amp;&amp; av.subTitle === undefined" class="field-title col-xs-12 no-padding"><strong>{{ ::av.prompt }}</strong></h4><h4 ng-if="av.title !== undefined &amp;&amp; av.title !== null" class="field-title col-xs-12 no-padding"><strong>{{ ::av.title }}</strong></h4><h5 ng-if="av.subTitle !== undefined" class="col-xs-12 no-padding">{{ ::av.subTitle }}</h5><div class="options col-xs-12 col-md-8"><div ng-if="av.helpText" class="help-text"><p><i class="fa fa-question-circle"></i><span>{{ ::av.helpText}}</span><span ng-if="av.guidelines"><a href="{{ ::av.guidelines}}" target="_blank">Submission guidelines</a></span></p></div><div ng-if="av.type==\'checkbox\'" ng-repeat="(option, enabled) in av.options" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="checkbox col-md-12 col-xs-12"><label><input type="checkbox" name="{{::item}}" ng-model="av.options[option]" ng-click="validate(item, av)"/>{{ ::option}}</label></div><div ng-if="av.type==\'radio\'" ng-repeat="option in av.options" ng-class="{\'inline\':av.inline}" style="margin: 0" class="radio col-md-6 col-xs-12"><label><input type="radio" ng-model="report.obs.travelAdvice.fields[item].value" value="{{ ::option}}"/>{{ ::option}}</label></div><div ng-if="av.type==\'number\'" ng-class="{\'inline\':av.inline}" class="number col-xs-12"><label><input type="number" name="{{::item}}" placeholder="{{ av.placeholder ? av.placeholder : \'Number between \'+ av.options.min +\' and \'+av.options.max }}" ng-model="report.obs.travelAdvice.fields[item].value" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'text\'" ng-class="{\'inline\':av.inline}" class="text col-xs-12"><label><input type="text" name="{{::item}}" placeholder="{{ ::av.prompt }}" ng-model="report.obs.travelAdvice.fields[item].value" ng-required="report.obs.travelAdvice.fields[av.constraint.field].options[av.constraint.option]" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'dropdown\'" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="select col-md-6 col-xs-12 no-padding"><select ng-options="option for option in av.options" ng-model="report.obs.travelAdvice.fields[item].value" class="form-control"><option value="">Select option</option></select></div><div ng-if="av.type==\'textarea\'" class="textarea col-xs-12"><textarea rows="3" ng-model="report.obs.travelAdvice.fields[item].value" class="form-control"></textarea></div><div ng-if="av.type==\'datetime\'" class="datetime-input col-xs-12"><label for="datetime"><input type="datetime" ng-model="report.obs.travelAdvice.fields[item].value" ac-datetime-picker="ac-datetime-picker" show-only-date="av.showOnlyDate" show-only-time="av.showOnlyTime" max-date-today="av.maxDateToday" placeholder="{{av.placeholder ? av.placeholder : \'Click to select date\'}}" class="form-control"/></label></div><div ng-if="acHotZoneForm[item].$invalid" class="error col-xs-12 no-padding">{{::av.errorMessage}}</div></div><div class="options col-xs-12 col-md-4"></div></div></div></div></div><div class="footer-buttons col-xs-12 no-padding"><input type="button" value="Back" ng-click="goBack(acHotZoneForm.$dirty)" class="btn btn-default btn-styled"/><div class="submit-btn"><i ng-show="submitting" class="fa fa-fw fa-lg fa-spinner fa-spin"></i><input type="button" ng-click="submitForm()" id="submit" value="SUBMIT" ng-disabled="report.latlng.length === 0 || submitting" class="btn btn-default btn-styled"/></div></div></form><div ng-if="error"><div role="alert" class="alert alert-danger"><p>There was an error submitting your report.</p><p ng-if="errormsg">{{errormsg}}</p></div></div></div>'),e.put("loading-indicator.html",'<div class="ac-loading-indicator"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>'),e.put("min-back-modal.html",'<div class="modal-body"><p>Are you sure you want to exit?</p><p>You will lose all your data!</p></div><div class="modal-footer"><button type="button" ng-click="discardAndExit()" class="btn btn-default">Yes</button><button type="button" ng-click="stayOnThePage()" class="btn btn-primary">No</button></div>'),e.put("min-map-modal.html",'<div class="modal-body"><input type="button" value="Save and close" ng-click="save()" class="btn btn-default save-button"/><div ac-location-select="ac-location-select" latlng="params.latlng" style="height: 100%; width: 100%;" ng-if="show"></div></div>'),e.put("min-observation-drawer.html",'<div class="panel"><div class="panel-body"><div class="row"><div ng-click="closeDrawer()" class="pull-right close-drawer"><i class="fa fa-close"></i></div><div class="col-sm-8 col-xs-12"><h3>{{sub.title}}</h3></div><div class="col-sm-3 col-xs-12"><a target="_blank" href="{{sponsor.getText(&quot;sponsor.url&quot;)}}" class="pull-right"><img ng-src="{{sponsor.getText(&quot;sponsor.image-229&quot;)}}"/></a></div></div><div class="row submission-header"><div class="col-sm-6 section-label"><i class="fa fa-clock-o"></i><span>Submitted</span></div><div class="col-sm-6 section-label full-page-link"><div ng-click="viewFullPage(sub.subid)" class="pull-right"><i class="fa fa-external-link"></i><span>full page</span></div></div><div class="col-sm-12"><p>By <span> {{sub.user}} </span></p><p>On {{sub.dateFormatted}}</p></div></div></div><div class="panel-body"><div class="row-fluid observation-tabs"><ul role="tablist" class="nav nav-pills nav-justified"><li ng-repeat="tab in reportTypes" role="presentation" ng-class="[hasReport(tab),{active: tab === sub.requested}]"><a ng-click="changeTab(tab)" style="text-transform: uppercase;" ng-class="tab">{{::tab}}</a></li></ul></div><div class="row-fluid"><div class="tab-content"><div ng-repeat="tab in reportTypes" role="tabpanel" id="{{tab}}" ng-class="{active: tab === sub.requested}" class="tab-pane"><div class="row-fluid section-label"><i class="fa fa-info-circle"></i><span>Information</span></div><div ng-repeat="ob in sub.obs"><div ng-if="ob.obtype === sub.requested" ng-repeat="item in activeTab" class="submission-header"><ul class="observation-information"><li ng-if="item.type === \'number\' || item.type === \'radio\' || item.type === \'dropdown\' || item.type === \'text\' " class="observation-item">{{item.prompt}} <span class="value">{{item.value}}</span></li><li ng-if="item.type === \'checkbox\'" class="observation-item">{{item.prompt}}<ul><li ng-repeat="op in item.value track by $index"><span class="value">{{op}}</span><span ng-if="!$last" class="value">, </span></li></ul></li><li ng-if="item.type === \'datetime\'" class="observation-item">{{item.prompt}}<span>&nbsp; {{item.value}}</span></li></ul><div ng-if="item.type === \'textarea\'" class="observation-item comments"><div class="row-fluid section-label"><i class="fa fa-comment"></i><span>Comments</span></div><div class="row-fluid"><div class="col-sm-12">{{item.value}}</div></div></div></div></div></div></div></div></div><div class="panel-body upload-n-share"><div ng-if="sub.uploads.length &gt; 0" class="row"><div class="col-sm-12 section-label"><i class="fa fa-camera"></i><span>Uploads (click/tap to enlarge)</span></div><div class="col-sm-12"><ul class="list-inline"><li ng-repeat="url in sub.thumbs"><a ng-href="{{url}}" target="_blank"><img ng-src="{{url}}" width="75" alt="{{sub.title}}"/></a></li></ul></div></div><div class="row"><div class="col-sm-12 section-label"><i class="fa fa-share-square-o"></i><span>Share this report</span></div><div class="col-sm-12"><div class="col-sm-12"><ul class="list-inline"><li><a ng-href="https://twitter.com/intent/tweet?status={{sub.shareUrl}}"><i class="fa fa-twitter fa-fw fa-lg"></i></a></li><li><a ng-href="https://www.facebook.com/sharer/sharer.php?u={{sub.shareUrl}}"><i class="fa fa-facebook fa-fw fa-lg"></i></a></li><li><a ng-href="https://plus.google.com/share?url={{sub.shareUrl}}"><i class="fa fa-google-plus fa-fw fa-lg"></i></a></li></ul></div></div></div></div></div>'),e.put("min-report-form.html",'<div class="min-form"><form name="acMinForm" novalidate="novalidate" ng-if="!report.subid" role="form" ac-submission-form-validator="ac-submission-form-validator"><div class="form-fields col-xs-12 no-padding"><div class="col-xs-12 col-md-4 form-left-column"><div class="required-info clearfix"><h3 class="form-subtitle">Step 1. Required Info</h3><div class="required-info-data col-xs-12"><div ng-class="{\'has-error\': !acMinForm.title.$valid &amp;&amp; acMinForm.title.$dirty }" class="form-group"><h4>Name your report</h4><input type="text" name="title" ng-model="report.title" placeholder="e.g. Upper Raft River" required="required" class="form-control"/></div><div ng-class="{\'has-error\': !acMinForm.datetime.$valid}" class="form-group"><h4> Submission date and time</h4><input type="datetime" name="datetime" ng-model="report.datetime" ac-datetime-picker="ac-datetime-picker" max-date-today="true" class="form-control"/></div><div ng-class="{\'has-error\': invalidLatLng}" class="form-group"><h4> Enter location by map</h4><div ng-click="openMapModal()" class="btn-map"><i class="fa fa-map-o"></i></div><h4>or enter location by lat/long</h4><input type="text" ng-class="{\'modified\': tempLatlngModified}" name="tempLatlng" ac-enter="saveLocation()" ng-model="report.tempLatlng" placeholder="e.g. 51.522, -188.883" required="required" class="form-control latlng"/><div role="button" ng-if="tempLatlngModified" ng-click="saveLocation()" class="save-location"><i class="fa fa-map-marker"></i></div><div ng-if="invalidLatLng" class="error col-xs-12 no-padding">Invalid coordinates format</div></div></div></div><div class="uploads"><h3 class="form-subtitle">Step 2. Uploads</h3><p>Add a photo (.jpg or .png) to help tell your story.</p><div class="help-text"><p><i class="fa fa-question-circle"></i>If uploading more than one photo, select all and submit photos together.</p></div><div class="form-group"><div class="col-xs-12 no-padding btn-file"><div class="col-xs-3 no-padding"><span class="btn btn-default btn-styled">Browse</span></div><input type="text" readonly="readonly" placeholder=".jpg or .png" value="{{ report.files.length ? report.files.length + \' photos added\' : null}}" class="col-xs-9 no-padding"/><input type="file" name="uploads" file-model="report.files" accept=".png,.jpg,.jpeg" multiple="multiple"/></div></div></div></div><div class="col-xs-12 col-md-8 form-right-column"><h3 id="top" class="form-subtitle">Step 3. Observations</h3><div class="announcement">Add information on one, some, or all tabs, then click SUBMIT at the bottom.</div><tabset type="pills" class="observation-tabs"><!--Quick report--><tab ac-tab-style="{{getTabExtraClasses(\'quickReport\')}}" active="tabs[\'quickReport\']"><tab-heading class="tab-head">Quick</tab-heading><div class="tab-text col-xs-12 col-md-8 no-padding">Use the Quick Report to quickly share information about your trip. You can create a comprehensive\nreport by adding more details in the Avalanche, Snowpack, Weather, and/or Incident tabs.</div><div class="fields-group col-xs-12 no-padding"><div ng-repeat="(item, ridingCondition) in report.obs.quickReport.ridingConditions" class="field col-xs-12"><h4 class="field-title col-xs-12 no-padding"><strong>{{ ::ridingCondition.prompt }}</strong></h4><div class="options col-xs-12 col-md-8"><div ng-if="ridingCondition.type==\'multiple\'" ng-repeat="(option, enabled) in ridingCondition.options" ng-class="{\'column-left\':$odd}" class="checkbox col-xs-12 col-md-6 inline"><label><input type="checkbox" name="{{ ::item}}" ng-model="ridingCondition.options[option]"/>{{ ::option}}</label></div><div ng-if="ridingCondition.type==\'single\'" ng-repeat="option in ridingCondition.options" class="radio col-xs-12 col-md-6 inline"><label><input type="radio" name="{{ ::item}}" ng-model="ridingCondition.selected" ng-value="option"/>{{ ::option}}</label></div></div><div class="options col-xs-12 col-md-4"></div></div><div class="field col-xs-12"><h4 class="field-title col-xs-12 no-padding"><strong>Avalanche conditions</strong></h4><div class="options col-xs-12 col-md-8"><div class="checkbox col-xs-12"><label><input type="checkbox" name="slab" ng-model="report.obs.quickReport.avalancheConditions.slab"/>Slab avalanches today or yesterday.</label></div><div class="checkbox col-xs-12"><label><input type="checkbox" name="sound" ng-model="report.obs.quickReport.avalancheConditions.sound"/>Whumpfing or drum-like sounds or shooting cracks.</label></div><div class="checkbox col-xs-12"><label><input type="checkbox" name="snow" ng-model="report.obs.quickReport.avalancheConditions.snow"/>30cm + of new snow, or significant drifitng, or rain in the last 48 hours.</label></div><div class="checkbox col-xs-12"><label><input type="checkbox" name="temp" ng-model="report.obs.quickReport.avalancheConditions.temp"/>Rapid temperature rise to near zero degrees or wet surface snow.</label></div></div><div class="options col-xs-12 col-md-4"></div></div><div class="field col-xs-12"><h4 class="field-title col-xs-12 no-padding"><strong>Comments</strong></h4><div class="options col-xs-12 col-md-8"><div class="help-text"><p><a href="http://www.avalanche.ca/fxresources/Submissions+Guidelines.pdf" target="_blank">Submission guidelines</a></p></div><div class="textarea col-xs-12"><textarea rows="3" name="comment" ng-model="report.obs.quickReport.comment" style="resize: vertical;" class="form-control"></textarea></div></div><div class="options col-xs-12 col-md-4"></div></div></div></tab><tab ng-repeat="(key, tab) in additionalFields" ac-tab-style="{{getTabExtraClasses(key)}}" active="tabs[key]"><tab-heading class="tab-head">{{ ::tab.name}}</tab-heading><div ng-bind-html="tab.text" class="tab-text col-xs-12 col-md-8 no-padding"></div><div class="fields-group col-xs-12 no-padding"><div ng-repeat="(item, av) in report.obs[key].fields" ng-if="av.type!==\'calculated\'" class="field col-xs-12"><h4 ng-if="av.title === undefined &amp;&amp; av.subTitle === undefined" class="field-title col-xs-12 no-padding"><strong>{{ ::av.prompt }}</strong></h4><h4 ng-if="av.title !== undefined &amp;&amp; av.title !== null" class="field-title col-xs-12 no-padding"><strong>{{ ::av.title }}</strong></h4><h5 ng-if="av.subTitle !== undefined" class="col-xs-12 no-padding">{{ ::av.subTitle }}</h5><div class="options col-xs-12 col-md-8"><div ng-if="av.helpText" class="help-text"><p><i class="fa fa-question-circle"></i><span>{{ ::av.helpText}}</span><span ng-if="av.guidelines"><a href="{{ ::av.guidelines}}" target="_blank">Submission guidelines</a></span></p></div><div ng-if="av.type==\'checkbox\'" ng-repeat="(option, enabled) in av.options" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="checkbox col-md-6 col-xs-12"><label><input type="checkbox" name="{{::item}}" ng-model="av.options[option]" ng-click="validate(item, av)"/>{{ ::option}}</label></div><div ng-if="av.type==\'radio\'" ng-repeat="option in av.options" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="radio col-md-6 col-xs-12"><label><input type="radio" ng-model="report.obs[key].fields[item].value" value="{{ ::option}}"/>{{ ::option}}</label></div><div ng-if="av.type==\'number\'" ng-class="{\'inline\':av.inline}" class="number col-xs-12"><label><input type="number" name="{{::item}}" placeholder="{{ av.placeholder ? av.placeholder : \'Number between \'+ av.options.min +\' and \'+av.options.max }}" ng-model="report.obs[key].fields[item].value" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'text\'" ng-class="{\'inline\':av.inline}" class="text col-xs-12"><label><input type="text" name="{{::item}}" placeholder="{{ ::av.prompt }}" ng-model="report.obs[key].fields[item].value" ng-required="report.obs[key].fields[av.constraint.field].options[av.constraint.option]" ng-blur="validate(item, av)" class="form-control"/></label></div><div ng-if="av.type==\'dropdown\'" ng-class="{\'inline\':av.inline, \'column-left\':$odd}" class="select col-md-6 col-xs-12 no-padding"><select ng-options="option for option in av.options" ng-model="report.obs[key].fields[item].value" class="form-control"><option value="">Select option</option></select></div><div ng-if="av.type==\'textarea\'" class="textarea col-xs-12"><textarea rows="3" ng-model="report.obs[key].fields[item].value" class="form-control"></textarea></div><div ng-if="av.type==\'datetime\'" class="datetime-input col-xs-12"><label for="datetime"><input type="datetime" ng-model="report.obs[key].fields[item].value" ac-datetime-picker="ac-datetime-picker" show-only-date="av.showOnlyDate" show-only-time="av.showOnlyTime" max-date-today="av.maxDateToday" placeholder="{{av.placeholder ? av.placeholder : \'Click to select date\'}}" class="form-control"/></label></div><div ng-if="acMinForm[item].$invalid" class="error col-xs-12 no-padding">{{::av.errorMessage}}</div></div><div class="options col-xs-12 col-md-4"></div></div></div></tab></tabset><tabset type="pills" class="observation-tabs bottom col-xs-12 no-padding"><!--Quick report--><tab ac-tab-style="{{getTabExtraClasses(\'quickReport\')}}" active="tabs[\'quickReport\']" ng-click="scrollToTop()"><tab-heading class="tab-head">Quick</tab-heading></tab><tab ng-repeat="(key, tab) in additionalFields" ac-tab-style="{{getTabExtraClasses(key)}}" active="tabs[key]" ng-click="scrollToTop()"><tab-heading class="tab-head">{{ ::tab.name}}</tab-heading></tab></tabset></div></div><div class="footer-buttons col-xs-12 no-padding"><input type="button" value="Back" ng-click="goBack(acMinForm.$dirty)" class="btn btn-default btn-styled"/><div class="submit-btn"><i ng-show="minsubmitting" class="fa fa-fw fa-lg fa-spinner fa-spin"></i><input type="button" ng-click="submitForm()" id="submit" value="SUBMIT" ng-disabled="report.latlng.length === 0 || minsubmitting" class="btn btn-default btn-styled"/></div></div></form><div ng-if="minerror"><div role="alert" class="alert alert-danger"><p>There was an error submitting your report.</p><p ng-if="minerrormsg">{{minerrormsg}}</p></div></div></div>'),e.put("min-report-fullpage.html",'<div class="panel"><div class="panel-body"><div class="row"><div ng-click="closeDrawer()" class="pull-right close-drawer"><i class="fa fa-close"></i></div><div class="col-sm-8 col-xs-12"><h3>{{::sub.title}}</h3></div><div class="col-sm-3 col-xs-12"><a target="_blank" href="{{sponsor.getText(&quot;sponsor.url&quot;)}}" class="pull-right"><img ng-src="{{sponsor.getText(&quot;sponsor.image-229&quot;)}}"/></a></div></div><div class="row submission-header"><div class="col-sm-6 section-label"><i class="fa fa-clock-o"></i><span>Submitted</span></div><div class="col-sm-6 section-label print-link"><div ng-click="print()" class="pull-right"><i class="fa fa-print"></i><span>Print friendly</span></div></div><div class="col-sm-12"><p>By <span> {{::sub.user}} </span></p><p>On {{::sub.dateFormatted}}</p></div></div></div><div ng-repeat="report in activeReports" class="panel-body observation-list"><div class="row-fluid observation-title">{{::report.obtype}} report</div><div class="row-fluid"><div class="row-fluid section-label"><i class="fa fa-info-circle"></i><span>Information</span></div><div ng-repeat="item in report.ob" class="submission-header"><ul class="observation-information"><li ng-if="item.type === \'number\' || item.type === \'radio\'|| item.type === \'dropdown\'" class="observation-item">{{::item.prompt}} <span class="value">{{::item.value}}</span></li><li ng-if="item.type === \'checkbox\'" class="observation-item">{{::item.prompt}}<ul><li ng-repeat="op in item.value track by $index"><span class="value">{{op}}</span><span ng-if="!$last" class="value">, </span></li></ul></li><li ng-if="item.type === \'datetime\'" class="observation-item">{{::item.prompt}}<span>&nbsp; {{::item.value | dateformat}}</span></li></ul><div ng-if="item.type === \'textarea\'" class="observation-item comments"><div class="row-fluid section-label"><i class="fa fa-comment"></i><span>Comments</span></div><div class="row-fluid"><div class="col-sm-12">{{::item.value}}</div></div></div></div></div></div><div class="panel-body upload-n-share"><div class="row-fluid observation-title">Uploads</div><div ng-if="sub.uploads.length &gt; 0" class="row"><div class="col-sm-12 section-label"><i class="fa fa-camera"></i><span>Uploads (click/tap to enlarge)</span></div><div class="col-sm-12"><ul class="list-inline"><li ng-repeat="url in sub.thumbs"><a ng-href="{{::url}}" target="_blank"><img ng-src="{{::url}}" width="75" alt="{{::sub.title}}"/></a></li></ul></div></div><div class="row share-report"><div class="col-sm-12 section-label"><i class="fa fa-share-square-o"></i><span>Share this report</span></div><div class="col-sm-12"><div class="col-sm-12"><ul class="list-inline"><li><a ng-href="https://twitter.com/intent/tweet?status={{::sub.shareUrl}}"><i class="fa fa-twitter fa-fw fa-lg"></i></a></li><li><a ng-href="https://www.facebook.com/sharer/sharer.php?u={{::sub.shareUrl}}"><i class="fa fa-facebook fa-fw fa-lg"></i></a></li><li><a ng-href="https://plus.google.com/share?url={{::sub.shareUrl}}"><i class="fa fa-google-plus fa-fw fa-lg"></i></a></li></ul></div></div></div></div></div>'),e.put("min-report-modal.html",'<div id="minForm" role="dialog" class="modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button data-dismiss="modal" class="close"><span>close</span></button><h4 class="modal-title">Mountain Information Network Report</h4></div><div class="modal-body"><div ac-min-report-form="ac-min-report-form"></div></div></div></div></div>'),e.put("min-report-popup-modal.html",'<div id="mobileMapPopup" role="dialog" class="modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"></div>                <a href="#" data-dismiss="modal" style="position: absolute; right: 10px; top: 10px;" class="pull-right"><i class="fa fa-close fa-lg"></i></a></div></div></div>'),e.put("social-share.html",'<div class="well"><H4>Share this report:</H4><ul class="list-inline"><li><a href="https://twitter.com/intent/tweet?url=http://avalanche.ca"><i class="fa fa-twitter fa-fw fa-lg"></i></a></li><li><a href="https://www.facebook.com/sharer/sharer.php?u=http://avalanche.ca"><i class="fa fa-facebook fa-fw fa-lg"></i></a></li><li><a href="https://plus.google.com/share?url=http://avalanche.ca"><i class="fa fa-google-plus fa-fw fa-lg"></i></a></li></ul></div>'),e.put("wbc-links.html",'<div class="row ac-forecast-mini--whistler-links"><div class="col-xs-10"><div class="panel panel-default first"><a href="" data-target="#collapseTwo" data-parent="#accordion" data-toggle="collapse" class="collapsed">{{disclaimer.getText(\'generic.title\')}}</a><div id="collapseTwo" class="collapse"><div class="panel-body"> <h3>USE AT YOUR OWN RISK</h3><p>The Whistler Blackcomb Avalanche Bulletin, and other information and services provided by Whistler Blackcomb and Avalanche Canada are intended for personal and recreational purposes only</p><p><b>THIS INFORMATION IS PROVIDED "AS IS" AND IN NO EVENT SHALL THE PROVIDERS BE LIABLE FOR ANY DAMAGES, INCLUDING, WITHOUT LIMITATION, DAMAGES RESULTING FROM DISCOMFORT, INJURY, OR DEATH, CLAIMS BY THIRD PARTIES OR FOR OTHER SIMILAR COSTS, OR ANY SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, ARISING OUT OF THE USE OF THE INFORMATION.</b></p><p>The user acknowledges that it is impossible to accurately predict natural events such as avalanches in every instance, and uses the data in this bulletin with this always foremost in mind. The accuracy or reliability of the data is not guaranteed or warranted in any way and the Providers disclaim liability of any kind whatsoever, including, without limitation, liability for quality, performance, merchantability and fitness for a particular purpose arising out of the use, or inability to use the data.</p></div></div></div><div><a target="_blank" href="http://www.whistlerblackcomb.com/">Whistler-Blackcomb Website</a></div><div><a target="_blank" href="http://www.whistlerheliskiing.com/">Whistler Heli-skiing Website</a></div><div><a target="_blank" href="http://www.extremelycanadian.com/">Extremely Canadian Website</a></div></div><div class="col-xs-2 social-media"><div><a href="https://twitter.com/whistlerblckcmb"><i class="fa fa-twitter-square"></i></a></div><div><a href="https://www.facebook.com/whistlerblackcomb"><i class="fa fa-facebook-square"></i></a></div><div><a href="/api/forecasts/whistler-blackcomb.rss"><i class="fa fa-rss-square"></i></a></div></div></div>')
}])}();